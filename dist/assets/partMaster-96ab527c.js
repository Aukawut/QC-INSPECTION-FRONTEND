import{Q as ae,f as Me,g as Ue,s as Ee,r as a,u as Fe,_ as Be,c as pe,h as e,i as We,l as $e,U as it,T as i,P as g,m as ee,M as qe,n as R,B as oe,S as De,v as Se,I as ie,t as ct,o as _e,V as dt,C as ut,X as ht,W as xt}from"./index-036dc118.js";import{A as mt}from"./AuthTokenAdmin-8e0d0dc5.js";import{S as O}from"./sweetalert2.all-d11f4fde.js";import{T as Ce,a as A,C as he,b as we,c as gt,d as ft,e as pt,f as jt,g as bt}from"./TableSortLabel-1e2a7b46.js";import{L as Ct}from"./label-f2919946.js";import{G as N}from"./KeyboardArrowRight-03236054.js";import{F as k,T as z,O as vt}from"./TextField-c50dbb77.js";import{C as Ne}from"./Card-0c8aa4b1.js";import{C as Pt}from"./Container-1491d26b.js";var Ve={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Le=ae.createContext&&ae.createContext(Ve),yt=["attr","size","title"];function St(t,r){if(t==null)return{};var s=wt(t,r),l,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);for(d=0;d<h.length;d++)l=h[d],!(r.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(t,l)&&(s[l]=t[l])}return s}function wt(t,r){if(t==null)return{};var s={},l=Object.keys(t),d,h;for(h=0;h<l.length;h++)d=l[h],!(r.indexOf(d)>=0)&&(s[d]=t[d]);return s}function je(){return je=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(t[l]=s[l])}return t},je.apply(this,arguments)}function Ae(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);r&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),s.push.apply(s,l)}return s}function be(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Ae(Object(s),!0).forEach(function(l){Nt(t,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Ae(Object(s)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(s,l))})}return t}function Nt(t,r,s){return r=kt(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function kt(t){var r=Ot(t,"string");return typeof r=="symbol"?r:String(r)}function Ot(t,r){if(typeof t!="object"||t===null)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var l=s.call(t,r||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Xe(t){return t&&t.map((r,s)=>ae.createElement(r.tag,be({key:s},r.attr),Xe(r.child)))}function Ye(t){return r=>ae.createElement(Rt,je({attr:be({},t.attr)},r),Xe(t.child))}function Rt(t){var r=s=>{var{attr:l,size:d,title:h}=t,C=St(t,yt),w=d||s.size||"1em",j;return s.className&&(j=s.className),t.className&&(j=(j?j+" ":"")+t.className),ae.createElement("svg",je({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,l,C,{className:j,style:be(be({color:t.color||s.color},s.style),t.style),height:w,width:w,xmlns:"http://www.w3.org/2000/svg"}),h&&ae.createElement("title",null,h),t.children)};return Le!==void 0?ae.createElement(Le.Consumer,null,s=>r(s)):r(Ve)}function He(t){return Ye({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"},child:[]}]})(t)}function Ge(t){return Ye({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M368.5 240h-225c-8.8 0-16 7.2-16 16 0 4.4 1.8 8.4 4.7 11.3 2.9 2.9 6.9 4.7 11.3 4.7h225c8.8 0 16-7.2 16-16s-7.2-16-16-16z"},child:[]}]})(t)}function zt(t){return Me("MuiCardContent",t)}Ue("MuiCardContent",["root"]);const Tt=["className","component"],_t=t=>{const{classes:r}=t;return $e({root:["root"]},zt,r)},Lt=Ee("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(t,r)=>r.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),At=a.forwardRef(function(r,s){const l=Fe({props:r,name:"MuiCardContent"}),{className:d,component:h="div"}=l,C=Be(l,Tt),w=pe({},l,{component:h}),j=_t(w);return e.jsx(Lt,pe({as:h,className:We(j.root,d),ownerState:w,ref:s},C))}),Je=At;function It(t){return Me("MuiTableContainer",t)}Ue("MuiTableContainer",["root"]);const Mt=["className","component"],Ut=t=>{const{classes:r}=t;return $e({root:["root"]},It,r)},Et=Ee("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(t,r)=>r.root})({width:"100%",overflowX:"auto"}),Ft=a.forwardRef(function(r,s){const l=Fe({props:r,name:"MuiTableContainer"}),{className:d,component:h="div"}=l,C=Be(l,Mt),w=pe({},l,{component:h}),j=Ut(w);return e.jsx(Et,pe({ref:s,as:h,className:We(j.root,d),ownerState:w},C))}),Bt=Ft,ye=[{id_result:"1-4",name_result:"Result X-Y Dir.A",checked:!1},{id_result:"2-5",name_result:"Result X-Y Dir.B",checked:!1},{id_result:"3-6",name_result:"Result X-Y Dir.C",checked:!1}];function Ke({query:t}){return e.jsx(Ce,{children:e.jsx(A,{align:"center",colSpan:9,sx:{py:3},children:e.jsxs(it,{sx:{textAlign:"center"},children:[e.jsx(i,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(i,{variant:"body2",children:["No results found for  ",e.jsxs("strong",{children:['"',t,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}Ke.propTypes={query:g.string};function Ze({isOpen:t,onClose:r,oldStandard:s,images:l,render:d}){const h=()=>{r(!1)};console.log("oldStandard",s);const C={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",borderRadius:"15px",boxShadow:"rgba(158, 199, 243, 0.65) 0 0 15px 2px",pt:2,px:4,pb:3},[w,j]=a.useState(""),[ce,U]=a.useState(""),[Y,te]=a.useState(""),[H,G]=a.useState(""),[se,$]=a.useState(""),[q,J]=a.useState(1),[T,K]=a.useState(!0),E="http://backend-qcinspection",[de,D]=a.useState([]);console.log("oldStandard",s);const F=a.useCallback(async()=>{await ee.post(`${E}/backend_qc_inspection/api`,{router:"getAllParts"}).then(o=>{o.data.err?D([]):!o.data.err&&o.data.status==="Ok"&&(console.log(o.data.result),D(o.data.result))})},[E]),[y,v]=a.useState([{usl:"",lsl:""}]),B=(o,x,b)=>{if(parseFloat(b)!==0){if(!/^\d*\.?\d{0,2}$/.test(b)){console.error("Invalid input. Please enter a valid float with up to 2 decimal places.");return}console.log(b.length),b<100&&v(P=>{const m=[...P];return x==="usl"?m[o]={...m[o],usl:b}:x==="lsl"&&(m[o]={...m[o],lsl:b}),m})}};console.log(s),console.log(y),console.log(de);const[I,f]=a.useState([]),xe=(o,x)=>{const b=[...I];b[x]={...b[x],checked:o},f(b)},me=async()=>{let o=0,x=0,b=0;const W=P=>/^\d{2,3}\.\d{2}$/.test(P);if(y.forEach(P=>{W(P.usl)?console.log("OK"):o+=1,W(P.lsl)?console.log("OK"):x+=1,P.lsl>P.usl&&(b+=1)}),x!==0)O.fire({icon:"warning",title:"Invalid format LSL",text:"Format ข้อมูล LSL ไม่ถูกต้อง"});else if(o!==0)O.fire({icon:"warning",title:"Invalid format USL",text:"Format ข้อมูล USL ไม่ถูกต้อง"});else if(b!==0)O.fire({icon:"warning",title:"Invalid Value",text:"USL ต้องมากกว่า LSL เท่านั้น"});else{const P={router:"updatePart",bsthPartNo:ce,partName:Y,customerPartNo:H,customerName:w,model:se,justOn:T?"X,Y":"AVG",standardValue:y==null?void 0:y.map((m,Z)=>({point:Z+1,lsl:m.lsl,usl:m.usl}))};ee.post(`${E}/backend_qc_inspection/api`,P).then(m=>{console.log(m.data),m.data.err?O.fire({icon:"error",title:m.data.msg}):!m.data.err&&m.data.status==="Ok"&&(h(),F(),d(),O.fire({icon:"success",title:m.data.msg,showCancelButton:!1,showConfirmButton:!1,timer:700}))}).catch(m=>{console.log(m)}),console.log(P),console.log(I)}};return console.log("pointCheck",y),a.useEffect(()=>{var P,m,Z,re,ne,Q,le,M;F(),s&&((P=s[0])==null?void 0:P.AMOUNT_POINT)!==void 0&&J(parseInt(s[0].AMOUNT_POINT,10)),j((m=s[0])==null?void 0:m.CUSTOMER_NAME),U((Z=s[0])==null?void 0:Z.BSNCR_PART_NO),te((re=s[0])==null?void 0:re.PART_NAME),G((ne=s[0])==null?void 0:ne.CUSTOMER_PART_NO),$((Q=s[0])==null?void 0:Q.MODEL),K(((le=s[0])==null?void 0:le.JUST_ON)==="X,Y");const o=s==null?void 0:s.map(V=>({usl:parseFloat(V.USL).toFixed(2),lsl:parseFloat(V.LSL).toFixed(2)})),x=(M=Array.from(new Set(o==null?void 0:o.map(JSON.stringify))))==null?void 0:M.map(JSON.parse),b=s==null?void 0:s.map(V=>V.NAME_RESULT),W=[...new Set(b)];f(W),v(x)},[F,s]),e.jsx(qe,{open:t,onClose:h,children:e.jsxs(R,{sx:{...C,width:"80%",height:"90%",overflow:"hidden",overflowY:"auto"},children:[e.jsx("div",{className:"w-[100%] flex justify-end absolute top-[1rem] right-[1rem]",children:e.jsx("button",{type:"button",className:"fa-solid fa-xmark text-[18px] text-red-500 cursor-pointer",onClick:h})}),e.jsx("h3",{children:"Update Standard Part"}),e.jsx("div",{className:"h-[90%] overflow-auto",children:e.jsxs(N,{container:!0,spacing:2,marginTop:2,children:[e.jsxs(N,{item:!0,xs:12,lg:5,children:[e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"PSTH Part No :"}),e.jsx(z,{disabled:!0,value:ce,onChange:o=>{U(o.target.value)},size:"small",placeholder:"BSTH PartNo"})]}),e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Part Name :"}),e.jsx(z,{disabled:!0,value:Y,onChange:o=>{te(o.target.value)},size:"small",placeholder:"Part name"})]}),e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Model :"}),e.jsx(z,{disabled:!0,value:se,onChange:o=>{$(o.target.value)},size:"small",placeholder:"Model"})]}),e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Customer :"}),e.jsx(z,{disabled:!0,value:w,onChange:o=>{j(o.target.value)},size:"small",placeholder:"Customer"})]}),e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Customer Part No :"}),e.jsx(z,{disabled:!0,fullWidth:!0,value:H,onChange:o=>{G(o.target.value)},size:"small",placeholder:"Customer Part No"})]}),e.jsx("div",{children:e.jsxs(k,{sx:{marginBottom:"0.5rem"},children:[e.jsxs(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:["Just : ",T?"X,Y":"Avg"]}),e.jsxs(R,{sx:{display:"flex",alignItems:"center",gap:"0px 10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(he,{value:"X,Y",checked:T,onChange:o=>{T||K(o.target.checked)}}),e.jsx(i,{children:"X,Y"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(he,{value:"AVG",checked:!T,onChange:o=>{K(!1)}}),e.jsx(i,{children:"AVG"})]})]})]})}),e.jsx("div",{children:e.jsxs(k,{children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px",marginBottom:1},children:"Drawing"}),Array.isArray(l)&&l.length>0?l==null?void 0:l.map(o=>e.jsx("a",{href:`${E}/backend_qc_inspection/uploads/drawing/${o.FILENAME}`,target:"_blank",rel:"noreferrer",children:e.jsx("div",{className:"rounded-lg h-[5rem] w-[8rem] border-[1.5px] flex justify-center items-center overflow-hidden",children:e.jsx("img",{className:"object-cover w-[auto] h-[100%]",alt:o.FILENAME,src:`${E}/backend_qc_inspection/uploads/drawing/${o.FILENAME}`})})})):e.jsx(i,{color:"red",fontSize:12,children:"ไม่ได้อัพโหลด Drawing"})]})})]}),e.jsxs(N,{item:!0,xs:12,lg:7,children:[e.jsxs(k,{sx:{marginBottom:"0.5rem"},children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Number of check points :"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px 10px"},children:[e.jsx(oe,{size:"small",color:"error",onClick:()=>{J(o=>o!==1?o-1:1),q!==1&&v(o=>o.slice(0,-1))},children:e.jsx(Ge,{fontSize:20})}),e.jsx(i,{fontWeight:"bold",children:q}),e.jsx(oe,{size:"small",onClick:()=>{J(o=>o<4?o+1:4),v(o=>q<4?[...o,{usl:"",lsl:""}]:o)},children:e.jsx(He,{fontSize:17})})]})]}),e.jsx(N,{container:!0,spacing:2,children:new Array(q).fill("").map((o,x)=>{var re,ne,Q,le;const W=(re=y[x])==null?void 0:re.usl,P=W!==void 0&&W.length!==5,m=(ne=y[x])==null?void 0:ne.lsl,Z=m!==void 0&&m.length!==5;return console.log(10),e.jsx(N,{item:!0,xs:12,lg:6,children:e.jsx(Ne,{children:e.jsxs(Je,{children:[e.jsx(R,{sx:{display:"flex"},children:e.jsxs(i,{fontSize:14,marginBottom:1,children:["Point Check No. ",x+1]})}),e.jsxs(R,{sx:{display:"flex",gap:"0px 5px"},children:[e.jsxs("div",{children:[e.jsxs(i,{fontSize:11,marginLeft:1,children:["LSL Point ",x+1]}),e.jsx(z,{size:"small",sx:{width:100},placeholder:`LSL ${x+1}`,value:(Q=y[x])==null?void 0:Q.lsl,onChange:M=>{B(x,"lsl",M.target.value)},error:Z})]}),e.jsxs("div",{children:[e.jsxs(i,{fontSize:11,marginLeft:1,children:["USL Point ",x+1]}),e.jsx(z,{size:"small",sx:{width:100},placeholder:`USL ${x+1}`,value:(le=y[x])==null?void 0:le.usl,error:P,onChange:M=>{B(x,"usl",M.target.value)}})]})]}),e.jsx(i,{color:"red",fontSize:12,marginTop:1,children:"*หมายเหตุ 00.01 - 99.99 เท่านั้น"})]})})},x)})}),e.jsx(N,{container:!0,children:e.jsxs(N,{item:!0,xs:12,lg:12,children:[e.jsxs("div",{className:"flex items-start mt-[1rem] gap-x-2",children:[e.jsx(i,{fontSize:14,fontWeight:"bold",children:"Result :"}),e.jsx(i,{fontSize:12,color:"red",children:"* Result ไม่สามารถแก้ไขได้"})]}),e.jsx(R,{sx:{display:"flex"},children:e.jsx("table",{style:{width:"100%"},children:e.jsx("tbody",{style:{fontSize:14},children:I==null?void 0:I.map((o,x)=>e.jsx("tr",{children:e.jsxs("td",{children:[e.jsx(he,{checked:!0,disabled:!0,onChange:b=>{xe(b.target.checked,x)}}),o]})},x))})})}),e.jsx(R,{children:e.jsx("div",{style:{marginTop:20},children:e.jsx("div",{children:e.jsx(oe,{variant:"contained",onClick:me,children:"Update"})})})})]})})]})]})})]})})}Ze.propTypes={isOpen:g.bool.isRequired,onClose:g.func.isRequired,oldStandard:g.array,images:g.array,render:g.func};function Qe({selected:t,bsthPartNo:r,partName:s,customerName:l,customerPartNo:d,model:h,justOn:C,point:w,getAllPart:j,file:ce,render:U}){const[Y,te]=a.useState(null),[H,G]=a.useState(!1),[se,$]=a.useState([]),[q,J]=a.useState([]),T="http://backend-qcinspection",K=`${T}/backend_qc_inspection/uploads/drawing`,E=v=>{te(v.currentTarget)},de=async(v,B,I)=>{await ee.post(`${T}/backend_qc_inspection/api`,{router:"getPathByBsthName",bsthPartNo:v,customerPartNo:B,customerName:I}).then(f=>{f.data.err?console.log(f.data.msg):!f.data.err&&f.data.status==="Ok"&&$(f.data.result)}),await ee.post(`${T}/backend_qc_inspection/api`,{router:"getDrawingImagePath",bsthPartNo:v}).then(f=>{f.data.err?console.log(f.data.msg):!f.data.err&&f.data.status==="Ok"&&(J(f.data.result),G(!0))})},D=()=>{te(null)},F=async(v,B,I)=>{const f=await ee.post(`${T}/backend_qc_inspection/api`,{router:"deletePart",bsthPartNo:v,customerPartNo:B,customerName:I});console.log(f.data),f.data.err?O.fire({icon:"error",title:f.data.msg}):!f.data.err&&f.data.status==="Ok"?(O.fire({icon:"success",title:f.data.msg,timer:700}),D(),j()):console.log("Something went wrong!")},y=()=>{G(!1),D()};return e.jsxs(e.Fragment,{children:[e.jsx(Ze,{isOpen:H,onClose:y,oldStandard:se,images:q,render:U}),e.jsxs(Ce,{hover:!0,tabIndex:-1,role:"checkbox",selected:t,children:[e.jsx(A,{sx:{fontSize:13},children:e.jsx("div",{className:"flex justify-center border-[1px]",children:e.jsx("img",{src:`${K}/${ce}`,alt:"partno",className:"h-[4rem] w-auto"})})}),e.jsx(A,{component:"th",scope:"row",padding:"none",sx:{fontSize:13},children:e.jsx(De,{direction:"row",alignItems:"center",spacing:2,padding:2,children:e.jsx(i,{variant:"subtitle2",noWrap:!0,sx:{fontSize:13},children:r})})}),e.jsx(A,{sx:{fontSize:13},children:e.jsx("div",{className:"w-[90px]",children:e.jsx(we,{title:s,children:e.jsx("p",{className:"truncate block w-full",children:s})})})}),e.jsx(A,{sx:{fontSize:13},children:e.jsx("div",{className:"w-[90px]",children:e.jsx("p",{className:"truncate block w-full",children:l})})}),e.jsx(A,{sx:{fontSize:13},children:h}),e.jsxs(A,{sx:{fontSize:13},children:[" ",e.jsx("div",{className:"w-[120px]",children:e.jsx("p",{className:"truncate block w-full",children:d})})]}),e.jsx(A,{sx:{fontSize:13},children:w}),e.jsx(A,{sx:{fontSize:13},children:e.jsx(Ct,{color:C==="XY"&&"info"||"primary",children:C})}),e.jsx(A,{align:"right",sx:{fontSize:13},children:e.jsx(Se,{onClick:E,children:e.jsx(ie,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(ct,{open:!!Y,anchorEl:Y,onClose:D,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(_e,{onClick:()=>{de(r,d,l)},children:[e.jsx(ie,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(_e,{onClick:()=>{O.fire({title:`ต้องการลบ ?  ${r}`,text:"ข้อมูลการ Inspection จะถูกลบด้วย!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"ใช่, ต้องการลบ!"}).then(v=>{v.isConfirmed&&F(r,d,l)})},sx:{color:"error.main"},children:[e.jsx(ie,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]})]})}Qe.propTypes={bsthPartNo:g.string,partName:g.string,customerName:g.string,customerPartNo:g.string,model:g.string,justOn:g.string,point:g.string,selected:g.any,getAllPart:g.func,file:g.string,render:g.func};const Wt={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function $t(t,r,s){return t?Math.max(0,(1+t)*r-s):0}function Ie(t,r,s){return t[s]===null?1:r[s]===null||r[s]<t[s]?-1:r[s]>t[s]?1:0}function qt(t,r){return t==="desc"?(s,l)=>Ie(s,l,r):(s,l)=>-Ie(s,l,r)}function Dt({inputData:t,comparator:r,filterName:s}){const l=t.map((d,h)=>[d,h]);return l.sort((d,h)=>{const C=r(d[0],h[0]);return C!==0?C:(console.log(C),d[1]-h[1])}),t=l.map(d=>d[0]),s&&(t=t.filter(d=>d.BSNCR_PART_NO.toLowerCase().indexOf(s.toLowerCase())!==-1)),console.log("inputData",t),t}function et({order:t,orderBy:r,headLabel:s}){return e.jsx(gt,{children:e.jsx(Ce,{children:s.map(l=>e.jsx(A,{align:l.align||"left",sortDirection:r===l.id?t:!1,sx:{width:l.width,minWidth:l.minWidth,fontSize:13.5},children:e.jsxs(ft,{hideSortIcon:!0,direction:r===l.id?t:"asc",children:[l.label,r===l.id?e.jsx(R,{sx:{...Wt},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}et.propTypes={order:g.oneOf(["asc","desc"]),orderBy:g.string,headLabel:g.array};function tt({emptyRows:t,height:r}){return t?e.jsx(Ce,{sx:{...r&&{height:r*t}},children:e.jsx(A,{colSpan:9})}):null}tt.propTypes={emptyRows:g.number,height:g.number};function st({numSelected:t,filterName:r,onFilterName:s}){return e.jsxs(dt,{sx:{height:96,display:"flex",justifyContent:"space-between",p:l=>l.spacing(0,1,0,3),...t>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t>0?e.jsxs(i,{component:"div",variant:"subtitle1",children:[t," selected"]}):e.jsx(vt,{value:r,onChange:s,placeholder:"Search PSTH Part No...",startAdornment:e.jsx(ut,{position:"start",children:e.jsx(ie,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),t>0?e.jsx(we,{title:"Delete",children:e.jsx(Se,{children:e.jsx(ie,{icon:"eva:trash-2-fill"})})}):e.jsx(we,{title:"Filter list",children:e.jsx(Se,{children:e.jsx(ie,{icon:"ic:round-filter-list"})})})]})}st.propTypes={numSelected:g.number,filterName:g.string,onFilterName:g.func};function Vt(){const[t,r]=a.useState(0),[s,l]=a.useState("asc"),[d,h]=a.useState("bsthPartNo"),[C,w]=a.useState(""),[j,ce]=a.useState(5),[U,Y]=a.useState([]),[te,H]=a.useState(!1),[G,se]=a.useState(""),[$,q]=a.useState(""),[J,T]=a.useState(""),[K,E]=a.useState(""),[de,D]=a.useState(""),[F,y]=a.useState(1),[v,B]=a.useState(!0),[I,f]=a.useState(!1),xe=a.useRef(null),me=a.useRef(null),[o,x]=a.useState(null),b=()=>{me.current.click()},W={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",borderRadius:"15px",boxShadow:"rgba(158, 199, 243, 0.65) 0 0 15px 2px",pt:2,px:4,pb:3},P=()=>{f(n=>!n)},m=(n,c)=>{c!==""&&(l(d===c&&s==="asc"?"desc":"asc"),h(c))},Z=(n,c)=>{r(c)},re=n=>{r(0),ce(parseInt(n.target.value,10))},ne=n=>{r(0),w(n.target.value)},Q=Dt({inputData:U,comparator:qt(s,d),filterName:C}),le=!Q.length&&!!C,M="http://backend-qcinspection",V=a.useCallback(async()=>{await ee.post(`${M}/backend_qc_inspection/api`,{router:"getAllParts"}).then(n=>{n.data.err?Y([]):!n.data.err&&n.data.status==="Ok"&&(console.log(n.data.result),Y(n.data.result))})},[M]),[X,ge]=a.useState([{usl:"",lsl:""}]),ke=(n,c,u)=>{if(parseFloat(u)!==0){if(!/^\d*\.?\d{0,2}$/.test(u)){console.error("Invalid input. Please enter a valid float with up to 2 decimal places.");return}console.log(u.length),u<=150&&ge(L=>{const p=[...L];return c==="usl"?p[n]={...p[n],usl:u}:c==="lsl"&&(p[n]={...p[n],lsl:u}),p})}};console.log(X),console.log(U);const[ue,ve]=a.useState([]),rt=(n,c)=>{const u=[...ue];u[c]={...u[c],checked:n},ve(u)},nt=n=>n.length>0?n.flatMap(L=>L.split("-").map(Number)).sort((L,p)=>L-p).join(","):"",Oe=()=>{q(""),T(""),E(""),se(""),D(""),B(!0),ge([{usl:"",lsl:""}]),y(1),ve(ye),x(null)},lt=async(n,c)=>{const u=new FormData;u.append("router","uploadFileImage"),u.append("file",n),u.append("bsthPartNo",c);const S=await ee.post(`${M}/backend_qc_inspection/api_formData`,u);console.log(S.data)},ot=async()=>{var L;let n=0,c=0;const u=(L=ue==null?void 0:ue.filter(p=>p.checked===!0))==null?void 0:L.map(p=>p.id_result),S=p=>/^\d{2,3}\.\d{2}$/.test(p);if(X.forEach(p=>{S(p.usl)?console.log("OK"):n+=1,S(p.lsl)?console.log("OK"):c+=1}),u.length>0)if(c!==0)O.fire({icon:"warning",title:"Invalid format LSL",text:"Format ข้อมูล LSL ไม่ถูกต้อง"});else if(n!==0)O.fire({icon:"warning",title:"Invalid format USL",text:"Format ข้อมูล USL ไม่ถูกต้อง"});else{const p={router:"addPart",bsthPartNo:$,partName:J,customerPartNo:K,customerName:G,model:de,justOn:v?"X,Y":"AVG",resultCheck:nt(u),standardValue:X==null?void 0:X.map((_,fe)=>({point:fe+1,lsl:_.lsl,usl:_.usl}))};await ee.post(`${M}/backend_qc_inspection/api`,p).then(_=>{_.data.err?O.fire({icon:"error",title:_.data.msg}):!_.data.err&&_.data.status==="Ok"&&(o!==null&&lt(o,$),Oe(),V(),H(!1),O.fire({icon:"success",title:_.data.msg,showCancelButton:!1,showConfirmButton:!1,timer:700}))}).catch(_=>{console.log(_)})}else O.fire({icon:"warning",title:"กรุณาเลือก Result"});console.log(o)},at=n=>{const c=/^[a-zA-Z0-9]*$/;let u=n.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"");u.length>9&&(u=u.slice(0,9));let S="";u.length>=7?S=`${u.slice(0,6)}-${u.slice(6)}`:S=u,c.test(u)?q(S):console.log("Only English characters are allowed.")};return a.useEffect(()=>{V(),ve(ye)},[V,I]),e.jsxs(Pt,{children:[e.jsxs(De,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(i,{variant:"h4",children:"Parts Master"}),e.jsx(oe,{variant:"contained",color:"inherit",startIcon:e.jsx(ie,{icon:"eva:plus-fill"}),onClick:()=>{H(!0),setTimeout(()=>{xe.current.focus()},100)},children:"New Part"})]}),e.jsx(qe,{open:te,onClose:()=>{H(!1),Oe()},"aria-labelledby":"child-modal-title","aria-describedby":"child-modal-description",children:e.jsxs(R,{sx:{...W,width:"80%",height:"90%",overflow:"hidden",overflowY:"auto"},children:[e.jsx("h3",{id:"child-modal-title",children:"Add Part and Setting standard"}),e.jsx("div",{className:"h-[90%] overflow-auto",children:e.jsxs(N,{container:!0,spacing:2,marginTop:2,children:[e.jsxs(N,{item:!0,xs:12,lg:5,children:[e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsxs(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:["PSTH PartNo : ",$]}),e.jsx(z,{value:$,inputRef:xe,onChange:at,size:"small",placeholder:"PSTH PartNo"})]}),e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Part Name :"}),e.jsx(z,{value:J,onChange:n=>{T(n.target.value)},size:"small",placeholder:"Part name"})]}),e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Model :"}),e.jsx(z,{value:de,onChange:n=>{D(n.target.value)},size:"small",placeholder:"Model"})]}),e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Customer :"}),e.jsx(z,{value:G,onChange:n=>{se(n.target.value)},size:"small",placeholder:"Customer"})]}),e.jsxs(k,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Customer Part No :"}),e.jsx(z,{fullWidth:!0,value:K,onChange:n=>{E(n.target.value)},size:"small",placeholder:"Customer Part No"})]}),e.jsx("div",{children:e.jsxs(k,{sx:{marginBottom:"0.5rem"},children:[e.jsxs(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:["Just : ",v?"X,Y":"Avg"]}),e.jsxs(R,{sx:{display:"flex",alignItems:"center",gap:"0px 10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(he,{value:"X,Y",checked:v,onChange:n=>{v||B(n.target.checked)}}),e.jsx(i,{children:"X,Y"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(he,{value:"AVG",checked:!v,onChange:n=>{B(!1)}}),e.jsx(i,{children:"AVG"})]})]})]})})]}),e.jsxs(N,{item:!0,xs:12,lg:7,children:[e.jsxs(k,{sx:{marginBottom:"0.5rem"},children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Number of check points :"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px 10px"},children:[e.jsx(oe,{size:"small",color:"error",onClick:()=>{y(n=>n!==1?n-1:1),F!==1&&ge(n=>n.slice(0,-1))},children:e.jsx(Ge,{fontSize:20})}),e.jsx(i,{fontWeight:"bold",children:F}),e.jsx(oe,{size:"small",onClick:()=>{y(n=>n<4?n+1:4),ge(n=>F<4?[...n,{usl:"",lsl:""}]:n)},children:e.jsx(He,{fontSize:17})})]})]}),e.jsx(N,{container:!0,spacing:2,children:new Array(F).fill("").map((n,c)=>{var fe,Re,ze,Te;const S=(fe=X[c])==null?void 0:fe.usl,L=S!==void 0&&S.length!==5,p=(Re=X[c])==null?void 0:Re.lsl,_=p!==void 0&&p.length!==5;return console.log(10),e.jsx(N,{item:!0,xs:12,lg:6,children:e.jsx(Ne,{children:e.jsxs(Je,{children:[e.jsx(R,{sx:{display:"flex"},children:e.jsxs(i,{fontSize:14,marginBottom:1,children:["Point Check No. ",c+1]})}),e.jsxs(R,{sx:{display:"flex",gap:"0px 5px"},children:[e.jsxs("div",{children:[e.jsxs(i,{fontSize:11,marginLeft:1,children:["LSL Point ",c+1]}),e.jsx(z,{size:"small",sx:{width:100},placeholder:`LSL ${c+1}`,value:(ze=X[c])==null?void 0:ze.lsl,onChange:Pe=>{ke(c,"lsl",Pe.target.value)},error:_})]}),e.jsxs("div",{children:[e.jsxs(i,{fontSize:11,marginLeft:1,children:["USL Point ",c+1]}),e.jsx(z,{size:"small",sx:{width:100},placeholder:`USL ${c+1}`,value:(Te=X[c])==null?void 0:Te.usl,error:L,onChange:Pe=>{ke(c,"usl",Pe.target.value)}})]})]}),e.jsx(i,{color:"red",fontSize:12,marginTop:1,children:"*หมายเหตุ 00.01 - 150.00 เท่านั้น"})]})})},c)})}),e.jsxs(N,{container:!0,children:[e.jsx(N,{item:!0,xs:12,lg:12,children:e.jsxs(R,{className:"flex items-center gap-x-1 mt-[1rem]",children:[e.jsx(i,{fontSize:12,children:"Upload File Image (.png, .jpg only) :"}),e.jsx("button",{className:"w-[2.5rem] cursor-pointer h-[2.5rem] border-2 flex justify-center items-center border-dashed",onClick:b,type:"button",children:e.jsx("i",{className:"fa-solid fa-plus text-blue-500 text-[12px]"})}),e.jsx("input",{ref:me,accept:".png, .jpg",style:{display:"none"},multiple:!0,type:"file",onChange:n=>{n.target.files[0].size/(1024*1024)>2?O.fire({icon:"warning",title:"Error File size",text:"อนุญาตอัพโหลดไม่เกิน 2 Mb ต่อไฟล์"}):n.target.files[0].type!=="image/jpeg"&&n.target.files[0].type!=="image/png"?O.fire({icon:"warning",title:"Error File type",text:"อนุญาตอัพโหลดไฟล์ .png .jpg เท่านั้น"}):x(n.target.files[0])}}),o!==null?e.jsx(i,{fontSize:12,color:"#0388fc",children:o.name}):null]})}),e.jsxs(N,{item:!0,xs:12,lg:12,children:[e.jsx(i,{fontSize:14,fontWeight:"bold",marginTop:"1rem",children:"Result :"}),e.jsx(R,{sx:{display:"flex"},children:e.jsx("table",{style:{width:"100%"},children:e.jsx("tbody",{style:{fontSize:14},children:ye.map((n,c)=>{var u,S;return e.jsx("tr",{children:e.jsxs("td",{children:[e.jsx(he,{defaultChecked:(u=ue[c])==null?void 0:u.checked,onChange:L=>{rt(L.target.checked,c)},checked:(S=ue[c])==null?void 0:S.checked}),n.name_result]})},c)})})})}),e.jsx(R,{children:e.jsx("div",{style:{marginTop:20},children:e.jsx("div",{children:e.jsx(oe,{variant:"contained",onClick:ot,children:"Submit"})})})})]})]})]})]})})]})}),e.jsxs(Ne,{children:[e.jsx(st,{filterName:C,onFilterName:ne}),e.jsx(ht,{children:e.jsx(Bt,{sx:{overflow:"unset"},children:e.jsxs(pt,{sx:{minWidth:800},children:[e.jsx(et,{order:s,orderBy:d,rowCount:U.length,onRequestSort:m,headLabel:[{id:"image",label:"Drawing"},{id:"bsthPartNo",label:"Part No."},{id:"partName",label:"Part name"},{id:"customerName",label:"Customer"},{id:"model",label:"Model",align:"center"},{id:"customerPartNo",label:"Customer Part"},{id:"point",label:"Point",align:"center"},{id:"justOn",label:"Judge"},{id:"",label:"Action"}]}),e.jsxs(jt,{children:[Q.slice(t*j,t*j+j).map(n=>e.jsx(Qe,{bsthPartNo:n.BSNCR_PART_NO,partName:n.PART_NAME,customerName:n.CUSTOMER_NAME,model:n.MODEL,customerPartNo:n.CUSTOMER_PART_NO,justOn:n.JUST_ON,point:n.AMOUNT_POINT,getAllPart:V,render:P,file:n.FILENAME},n.Id)),e.jsx(tt,{height:77,emptyRows:$t(t,j,U.length)}),le&&e.jsx(Ke,{query:C})]})]})})}),e.jsx(bt,{page:t,component:"div",count:U.length,rowsPerPage:j,onPageChange:Z,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:re})]})]})}function ts(){return e.jsxs(e.Fragment,{children:[e.jsx(mt,{}),e.jsx(xt,{children:e.jsx("title",{children:" Lists | Parts Master"})}),e.jsx(Vt,{})]})}export{ts as default};
