import{Q as ae,f as Ue,g as Ee,s as Fe,r as o,u as Be,_ as We,c as ge,h as e,i as $e,l as qe,U as ct,T as i,P as m,m as Z,M as De,n as _,B as le,S as Ve,v as Se,I as oe,t as dt,o as Le,V as ut,C as ht,X as xt,W as mt}from"./index-2c69281d.js";import{A as ft}from"./AuthTokenAdmin-013c9de1.js";import{S as z}from"./sweetalert2.all-34f271eb.js";import{T as be,a as I,C as he,b as we,c as gt,d as pt,e as jt,f as bt,g as Ct}from"./TableSortLabel-69ccbb78.js";import{L as vt}from"./label-282cadd9.js";import{G as O}from"./KeyboardArrowRight-13bf3a5b.js";import{F as R,T as L,O as Pt}from"./TextField-d07e4572.js";import{C as Ne}from"./Card-d7aae708.js";import{C as yt}from"./Container-bfd5118f.js";var Xe={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Ae=ae.createContext&&ae.createContext(Xe),St=["attr","size","title"];function wt(t,r){if(t==null)return{};var s=Nt(t,r),l,d;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);for(d=0;d<h.length;d++)l=h[d],!(r.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(t,l)&&(s[l]=t[l])}return s}function Nt(t,r){if(t==null)return{};var s={},l=Object.keys(t),d,h;for(h=0;h<l.length;h++)d=l[h],!(r.indexOf(d)>=0)&&(s[d]=t[d]);return s}function pe(){return pe=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(t[l]=s[l])}return t},pe.apply(this,arguments)}function Ie(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);r&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),s.push.apply(s,l)}return s}function je(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Ie(Object(s),!0).forEach(function(l){kt(t,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Ie(Object(s)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(s,l))})}return t}function kt(t,r,s){return r=Ot(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function Ot(t){var r=Rt(t,"string");return typeof r=="symbol"?r:String(r)}function Rt(t,r){if(typeof t!="object"||t===null)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var l=s.call(t,r||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Ye(t){return t&&t.map((r,s)=>ae.createElement(r.tag,je({key:s},r.attr),Ye(r.child)))}function He(t){return r=>ae.createElement(zt,pe({attr:je({},t.attr)},r),Ye(t.child))}function zt(t){var r=s=>{var{attr:l,size:d,title:h}=t,C=wt(t,St),w=d||s.size||"1em",p;return s.className&&(p=s.className),t.className&&(p=(p?p+" ":"")+t.className),ae.createElement("svg",pe({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,l,C,{className:p,style:je(je({color:t.color||s.color},s.style),t.style),height:w,width:w,xmlns:"http://www.w3.org/2000/svg"}),h&&ae.createElement("title",null,h),t.children)};return Ae!==void 0?ae.createElement(Ae.Consumer,null,s=>r(s)):r(Xe)}function Ge(t){return He({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"},child:[]}]})(t)}function Je(t){return He({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M368.5 240h-225c-8.8 0-16 7.2-16 16 0 4.4 1.8 8.4 4.7 11.3 2.9 2.9 6.9 4.7 11.3 4.7h225c8.8 0 16-7.2 16-16s-7.2-16-16-16z"},child:[]}]})(t)}function Tt(t){return Ue("MuiCardContent",t)}Ee("MuiCardContent",["root"]);const _t=["className","component"],Lt=t=>{const{classes:r}=t;return qe({root:["root"]},Tt,r)},At=Fe("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(t,r)=>r.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),It=o.forwardRef(function(r,s){const l=Be({props:r,name:"MuiCardContent"}),{className:d,component:h="div"}=l,C=We(l,_t),w=ge({},l,{component:h}),p=Lt(w);return e.jsx(At,ge({as:h,className:$e(p.root,d),ownerState:w,ref:s},C))}),Ke=It;function Mt(t){return Ue("MuiTableContainer",t)}Ee("MuiTableContainer",["root"]);const Ut=["className","component"],Et=t=>{const{classes:r}=t;return qe({root:["root"]},Mt,r)},Ft=Fe("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(t,r)=>r.root})({width:"100%",overflowX:"auto"}),Bt=o.forwardRef(function(r,s){const l=Be({props:r,name:"MuiTableContainer"}),{className:d,component:h="div"}=l,C=We(l,Ut),w=ge({},l,{component:h}),p=Et(w);return e.jsx(Ft,ge({ref:s,as:h,className:$e(p.root,d),ownerState:w},C))}),Wt=Bt,ye=[{id_result:"1-4",name_result:"Result X-Y Dir.A",checked:!1},{id_result:"2-5",name_result:"Result X-Y Dir.B",checked:!1},{id_result:"3-6",name_result:"Result X-Y Dir.C",checked:!1}];function Ze({query:t}){return e.jsx(be,{children:e.jsx(I,{align:"center",colSpan:9,sx:{py:3},children:e.jsxs(ct,{sx:{textAlign:"center"},children:[e.jsx(i,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(i,{variant:"body2",children:["No results found for  ",e.jsxs("strong",{children:['"',t,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}Ze.propTypes={query:m.string};function Qe({isOpen:t,onClose:r,oldStandard:s,images:l,render:d}){const h=()=>{r(!1)};console.log("oldStandard",s);const C={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",borderRadius:"15px",boxShadow:"rgba(158, 199, 243, 0.65) 0 0 15px 2px",pt:2,px:4,pb:3},[w,p]=o.useState(""),[ie,E]=o.useState(""),[X,Q]=o.useState(""),[Y,H]=o.useState(""),[ee,q]=o.useState(""),[D,G]=o.useState(1),[A,J]=o.useState(!0),F="http://backend-qcinspection",[ce,V]=o.useState([]);console.log("oldStandard",s);const B=o.useCallback(async()=>{await Z.post(`${F}/backend_qc_inspection/api`,{router:"getAllParts"}).then(a=>{a.data.err?V([]):!a.data.err&&a.data.status==="Ok"&&(console.log(a.data.result),V(a.data.result))})},[F]),[y,v]=o.useState([{usl:"",lsl:""}]),W=(a,x,j)=>{if(parseFloat(j)!==0){if(!/^\d*\.?\d{0,2}$/.test(j)){console.error("Invalid input. Please enter a valid float with up to 2 decimal places.");return}console.log(j.length),j<100&&v(b=>{const k=[...b];return x==="usl"?k[a]={...k[a],usl:j}:x==="lsl"&&(k[a]={...k[a],lsl:j}),k})}};console.log(s),console.log(y),console.log(ce);const[M,f]=o.useState([]),xe=(a,x)=>{const j=[...M];j[x]={...j[x],checked:a},f(j)},te=a=>/^\d{2,3}\.\d{2}$/.test(a.trim()),se=async()=>{let a=0,x=0,j=0;if(y.forEach(N=>{te(N.usl)?console.log("OK"):a+=1,te(N.lsl)?console.log("OK"):x+=1,N.lsl>N.usl&&(j+=1)}),x!==0)z.fire({icon:"warning",title:"Invalid format LSL",text:"Format ข้อมูล LSL ไม่ถูกต้อง"});else if(a!==0)z.fire({icon:"warning",title:"Invalid format USL",text:"Format ข้อมูล USL ไม่ถูกต้อง"});else if(j!==0)z.fire({icon:"warning",title:"Invalid Value",text:"USL ต้องมากกว่า LSL เท่านั้น"});else{const N={router:"updatePart",bsthPartNo:ie,partName:X,customerPartNo:Y,customerName:w,model:ee,justOn:A?"X,Y":"AVG",standardValue:y==null?void 0:y.map((b,k)=>({point:k+1,lsl:b.lsl,usl:b.usl}))};Z.post(`${F}/backend_qc_inspection/api`,N).then(b=>{console.log(b.data),b.data.err?z.fire({icon:"error",title:b.data.msg}):!b.data.err&&b.data.status==="Ok"&&(h(),B(),d(),z.fire({icon:"success",title:b.data.msg,showCancelButton:!1,showConfirmButton:!1,timer:700}))}).catch(b=>{console.log(b)}),console.log(N),console.log(M)}};return console.log("pointCheck",y),o.useEffect(()=>{var b,k,de,re,K,ne,$,U;B(),s&&((b=s[0])==null?void 0:b.AMOUNT_POINT)!==void 0&&G(parseInt(s[0].AMOUNT_POINT,10)),p((k=s[0])==null?void 0:k.CUSTOMER_NAME),E((de=s[0])==null?void 0:de.BSNCR_PART_NO),Q((re=s[0])==null?void 0:re.PART_NAME),H((K=s[0])==null?void 0:K.CUSTOMER_PART_NO),q((ne=s[0])==null?void 0:ne.MODEL),J((($=s[0])==null?void 0:$.JUST_ON)==="X,Y");const a=s==null?void 0:s.map(T=>({usl:parseFloat(T.USL).toFixed(2),lsl:parseFloat(T.LSL).toFixed(2)})),x=(U=Array.from(new Set(a==null?void 0:a.map(JSON.stringify))))==null?void 0:U.map(JSON.parse),j=s==null?void 0:s.map(T=>T.NAME_RESULT),N=[...new Set(j)];f(N),v(x)},[B,s]),e.jsx(De,{open:t,onClose:h,children:e.jsxs(_,{sx:{...C,width:"80%",height:"90%",overflow:"hidden",overflowY:"auto"},children:[e.jsx("div",{className:"w-[100%] flex justify-end absolute top-[1rem] right-[1rem]",children:e.jsx("button",{type:"button",className:"fa-solid fa-xmark text-[18px] text-red-500 cursor-pointer",onClick:h})}),e.jsx("h3",{children:"Update Standard Part"}),e.jsx("div",{className:"h-[90%] overflow-auto",children:e.jsxs(O,{container:!0,spacing:2,marginTop:2,children:[e.jsxs(O,{item:!0,xs:12,lg:5,children:[e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"PSTH Part No :"}),e.jsx(L,{disabled:!0,value:ie,onChange:a=>{E(a.target.value)},size:"small",placeholder:"BSTH PartNo"})]}),e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Part Name :"}),e.jsx(L,{disabled:!0,value:X,onChange:a=>{Q(a.target.value)},size:"small",placeholder:"Part name"})]}),e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Model :"}),e.jsx(L,{disabled:!0,value:ee,onChange:a=>{q(a.target.value)},size:"small",placeholder:"Model"})]}),e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Customer :"}),e.jsx(L,{disabled:!0,value:w,onChange:a=>{p(a.target.value)},size:"small",placeholder:"Customer"})]}),e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Customer Part No :"}),e.jsx(L,{disabled:!0,fullWidth:!0,value:Y,onChange:a=>{H(a.target.value)},size:"small",placeholder:"Customer Part No"})]}),e.jsx("div",{children:e.jsxs(R,{sx:{marginBottom:"0.5rem"},children:[e.jsxs(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:["Just : ",A?"X,Y":"Avg"]}),e.jsxs(_,{sx:{display:"flex",alignItems:"center",gap:"0px 10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(he,{value:"X,Y",checked:A,onChange:a=>{A||J(a.target.checked)}}),e.jsx(i,{children:"X,Y"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(he,{value:"AVG",checked:!A,onChange:a=>{J(!1)}}),e.jsx(i,{children:"AVG"})]})]})]})}),e.jsx("div",{children:e.jsxs(R,{children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px",marginBottom:1},children:"Drawing"}),Array.isArray(l)&&l.length>0?l==null?void 0:l.map(a=>e.jsx("a",{href:`${F}/backend_qc_inspection/uploads/drawing/${a.FILENAME}`,target:"_blank",rel:"noreferrer",children:e.jsx("div",{className:"rounded-lg h-[5rem] w-[8rem] border-[1.5px] flex justify-center items-center overflow-hidden",children:e.jsx("img",{className:"object-cover w-[auto] h-[100%]",alt:a.FILENAME,src:`${F}/backend_qc_inspection/uploads/drawing/${a.FILENAME}`})})})):e.jsx(i,{color:"red",fontSize:12,children:"ไม่ได้อัพโหลด Drawing"})]})})]}),e.jsxs(O,{item:!0,xs:12,lg:7,children:[e.jsxs(R,{sx:{marginBottom:"0.5rem"},children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Number of check points :"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px 10px"},children:[e.jsx(le,{size:"small",color:"error",onClick:()=>{G(a=>a!==1?a-1:1),D!==1&&v(a=>a.slice(0,-1))},children:e.jsx(Je,{fontSize:20})}),e.jsx(i,{fontWeight:"bold",children:D}),e.jsx(le,{size:"small",onClick:()=>{G(a=>a<4?a+1:4),v(a=>D<4?[...a,{usl:"",lsl:""}]:a)},children:e.jsx(Ge,{fontSize:17})})]})]}),e.jsx(O,{container:!0,spacing:2,children:new Array(D).fill("").map((a,x)=>{var re,K,ne,$;const N=(re=y[x])==null?void 0:re.usl,b=N!==void 0&&te(N)===!1,k=(K=y[x])==null?void 0:K.lsl,de=k!==void 0&&te(k)===!1;return console.log(10),e.jsx(O,{item:!0,xs:12,lg:6,children:e.jsx(Ne,{children:e.jsxs(Ke,{children:[e.jsx(_,{sx:{display:"flex"},children:e.jsxs(i,{fontSize:14,marginBottom:1,children:["Point Check No. ",x+1]})}),e.jsxs(_,{sx:{display:"flex",gap:"0px 5px"},children:[e.jsxs("div",{children:[e.jsxs(i,{fontSize:11,marginLeft:1,children:["LSL Point ",x+1]}),e.jsx(L,{size:"small",sx:{width:100},placeholder:`LSL ${x+1}`,value:(ne=y[x])==null?void 0:ne.lsl,onChange:U=>{W(x,"lsl",U.target.value)},error:de})]}),e.jsxs("div",{children:[e.jsxs(i,{fontSize:11,marginLeft:1,children:["USL Point ",x+1]}),e.jsx(L,{size:"small",sx:{width:100},placeholder:`USL ${x+1}`,value:($=y[x])==null?void 0:$.usl,error:b,onChange:U=>{W(x,"usl",U.target.value)}})]})]}),e.jsx(i,{color:"red",fontSize:12,marginTop:1,children:"*หมายเหตุ 00.01 - 99.99 เท่านั้น"})]})})},x)})}),e.jsx(O,{container:!0,children:e.jsxs(O,{item:!0,xs:12,lg:12,children:[e.jsxs("div",{className:"flex items-start mt-[1rem] gap-x-2",children:[e.jsx(i,{fontSize:14,fontWeight:"bold",children:"Result :"}),e.jsx(i,{fontSize:12,color:"red",children:"* Result ไม่สามารถแก้ไขได้"})]}),e.jsx(_,{sx:{display:"flex"},children:e.jsx("table",{style:{width:"100%"},children:e.jsx("tbody",{style:{fontSize:14},children:M==null?void 0:M.map((a,x)=>e.jsx("tr",{children:e.jsxs("td",{children:[e.jsx(he,{checked:!0,disabled:!0,onChange:j=>{xe(j.target.checked,x)}}),a]})},x))})})}),e.jsx(_,{children:e.jsx("div",{style:{marginTop:20},children:e.jsx("div",{children:e.jsx(le,{variant:"contained",onClick:se,children:"Update"})})})})]})})]})]})})]})})}Qe.propTypes={isOpen:m.bool.isRequired,onClose:m.func.isRequired,oldStandard:m.array,images:m.array,render:m.func};function et({selected:t,bsthPartNo:r,partName:s,customerName:l,customerPartNo:d,model:h,justOn:C,point:w,getAllPart:p,file:ie,render:E}){const[X,Q]=o.useState(null),[Y,H]=o.useState(!1),[ee,q]=o.useState([]),[D,G]=o.useState([]),A="http://backend-qcinspection",J=`${A}/backend_qc_inspection/uploads/drawing`,F=v=>{Q(v.currentTarget)},ce=async(v,W,M)=>{await Z.post(`${A}/backend_qc_inspection/api`,{router:"getPathByBsthName",bsthPartNo:v,customerPartNo:W,customerName:M}).then(f=>{f.data.err?console.log(f.data.msg):!f.data.err&&f.data.status==="Ok"&&q(f.data.result)}),await Z.post(`${A}/backend_qc_inspection/api`,{router:"getDrawingImagePath",bsthPartNo:v}).then(f=>{f.data.err?console.log(f.data.msg):!f.data.err&&f.data.status==="Ok"&&(G(f.data.result),H(!0))})},V=()=>{Q(null)},B=async(v,W,M)=>{const f=await Z.post(`${A}/backend_qc_inspection/api`,{router:"deletePart",bsthPartNo:v,customerPartNo:W,customerName:M});console.log(f.data),f.data.err?z.fire({icon:"error",title:f.data.msg}):!f.data.err&&f.data.status==="Ok"?(z.fire({icon:"success",title:f.data.msg,timer:700}),V(),p()):console.log("Something went wrong!")},y=()=>{H(!1),V()};return e.jsxs(e.Fragment,{children:[e.jsx(Qe,{isOpen:Y,onClose:y,oldStandard:ee,images:D,render:E}),e.jsxs(be,{hover:!0,tabIndex:-1,role:"checkbox",selected:t,children:[e.jsx(I,{sx:{fontSize:13},children:e.jsx("div",{className:"flex justify-center border-[1px]",children:e.jsx("img",{src:`${J}/${ie}`,alt:"partno",className:"h-[4rem] w-auto"})})}),e.jsx(I,{component:"th",scope:"row",padding:"none",sx:{fontSize:13},children:e.jsx(Ve,{direction:"row",alignItems:"center",spacing:2,padding:2,children:e.jsx(i,{variant:"subtitle2",noWrap:!0,sx:{fontSize:13},children:r})})}),e.jsx(I,{sx:{fontSize:13},children:e.jsx("div",{className:"w-[90px]",children:e.jsx(we,{title:s,children:e.jsx("p",{className:"truncate block w-full",children:s})})})}),e.jsx(I,{sx:{fontSize:13},children:e.jsx("div",{className:"w-[90px]",children:e.jsx("p",{className:"truncate block w-full",children:l})})}),e.jsx(I,{sx:{fontSize:13},children:h}),e.jsxs(I,{sx:{fontSize:13},children:[" ",e.jsx("div",{className:"w-[120px]",children:e.jsx("p",{className:"truncate block w-full",children:d})})]}),e.jsx(I,{sx:{fontSize:13},children:w}),e.jsx(I,{sx:{fontSize:13},children:e.jsx(vt,{color:C==="XY"&&"info"||"primary",children:C})}),e.jsx(I,{align:"right",sx:{fontSize:13},children:e.jsx(Se,{onClick:F,children:e.jsx(oe,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(dt,{open:!!X,anchorEl:X,onClose:V,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(Le,{onClick:()=>{ce(r,d,l)},children:[e.jsx(oe,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(Le,{onClick:()=>{z.fire({title:`ต้องการลบ ?  ${r}`,text:"ข้อมูลการ Inspection จะถูกลบด้วย!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"ใช่, ต้องการลบ!"}).then(v=>{v.isConfirmed&&B(r,d,l)})},sx:{color:"error.main"},children:[e.jsx(oe,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]})]})}et.propTypes={bsthPartNo:m.string,partName:m.string,customerName:m.string,customerPartNo:m.string,model:m.string,justOn:m.string,point:m.string,selected:m.any,getAllPart:m.func,file:m.string,render:m.func};const $t={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function qt(t,r,s){return t?Math.max(0,(1+t)*r-s):0}function Me(t,r,s){return t[s]===null?1:r[s]===null||r[s]<t[s]?-1:r[s]>t[s]?1:0}function Dt(t,r){return t==="desc"?(s,l)=>Me(s,l,r):(s,l)=>-Me(s,l,r)}function Vt({inputData:t,comparator:r,filterName:s}){const l=t.map((d,h)=>[d,h]);return l.sort((d,h)=>{const C=r(d[0],h[0]);return C!==0?C:(console.log(C),d[1]-h[1])}),t=l.map(d=>d[0]),s&&(t=t.filter(d=>d.BSNCR_PART_NO.toLowerCase().indexOf(s.toLowerCase())!==-1)),console.log("inputData",t),t}function tt({order:t,orderBy:r,headLabel:s}){return e.jsx(gt,{children:e.jsx(be,{children:s.map(l=>e.jsx(I,{align:l.align||"left",sortDirection:r===l.id?t:!1,sx:{width:l.width,minWidth:l.minWidth,fontSize:13.5},children:e.jsxs(pt,{hideSortIcon:!0,direction:r===l.id?t:"asc",children:[l.label,r===l.id?e.jsx(_,{sx:{...$t},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))})})}tt.propTypes={order:m.oneOf(["asc","desc"]),orderBy:m.string,headLabel:m.array};function st({emptyRows:t,height:r}){return t?e.jsx(be,{sx:{...r&&{height:r*t}},children:e.jsx(I,{colSpan:9})}):null}st.propTypes={emptyRows:m.number,height:m.number};function rt({numSelected:t,filterName:r,onFilterName:s}){return e.jsxs(ut,{sx:{height:96,display:"flex",justifyContent:"space-between",p:l=>l.spacing(0,1,0,3),...t>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t>0?e.jsxs(i,{component:"div",variant:"subtitle1",children:[t," selected"]}):e.jsx(Pt,{value:r,onChange:s,placeholder:"Search PSTH Part No...",startAdornment:e.jsx(ht,{position:"start",children:e.jsx(oe,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),t>0?e.jsx(we,{title:"Delete",children:e.jsx(Se,{children:e.jsx(oe,{icon:"eva:trash-2-fill"})})}):e.jsx(we,{title:"Filter list",children:e.jsx(Se,{children:e.jsx(oe,{icon:"ic:round-filter-list"})})})]})}rt.propTypes={numSelected:m.number,filterName:m.string,onFilterName:m.func};function Xt(){const[t,r]=o.useState(0),[s,l]=o.useState("asc"),[d,h]=o.useState("bsthPartNo"),[C,w]=o.useState(""),[p,ie]=o.useState(5),[E,X]=o.useState([]),[Q,Y]=o.useState(!1),[H,ee]=o.useState(""),[q,D]=o.useState(""),[G,A]=o.useState(""),[J,F]=o.useState(""),[ce,V]=o.useState(""),[B,y]=o.useState(1),[v,W]=o.useState(!0),[M,f]=o.useState(!1),xe=o.useRef(null),te=o.useRef(null),[se,a]=o.useState(null),x=()=>{te.current.click()},j={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",borderRadius:"15px",boxShadow:"rgba(158, 199, 243, 0.65) 0 0 15px 2px",pt:2,px:4,pb:3},N=()=>{f(n=>!n)},b=(n,c)=>{c!==""&&(l(d===c&&s==="asc"?"desc":"asc"),h(c))},k=(n,c)=>{r(c)},de=n=>{r(0),ie(parseInt(n.target.value,10))},re=n=>{r(0),w(n.target.value)},K=Vt({inputData:E,comparator:Dt(s,d),filterName:C}),ne=!K.length&&!!C,$="http://backend-qcinspection",U=o.useCallback(async()=>{await Z.post(`${$}/backend_qc_inspection/api`,{router:"getAllParts"}).then(n=>{n.data.err?X([]):!n.data.err&&n.data.status==="Ok"&&(console.log(n.data.result),X(n.data.result))})},[$]),[T,me]=o.useState([{usl:"",lsl:""}]),ke=(n,c,u)=>{if(parseFloat(u)!==0){if(!/^\d*\.?\d{0,2}$/.test(u)){console.error("Invalid input. Please enter a valid float with up to 2 decimal places.");return}console.log(u.length),u<=150&&me(P=>{const g=[...P];return c==="usl"?g[n]={...g[n],usl:u}:c==="lsl"&&(g[n]={...g[n],lsl:u}),g})}};console.log(T),console.log(E);const[ue,Ce]=o.useState([]),nt=(n,c)=>{const u=[...ue];u[c]={...u[c],checked:n},Ce(u)},lt=n=>n.length>0?n.flatMap(P=>P.split("-").map(Number)).sort((P,g)=>P-g).join(","):"",Oe=()=>{D(""),A(""),F(""),ee(""),V(""),W(!0),me([{usl:"",lsl:""}]),y(1),Ce(ye),a(null)},at=async(n,c)=>{const u=new FormData;u.append("router","uploadFileImage"),u.append("file",n),u.append("bsthPartNo",c);const S=await Z.post(`${$}/backend_qc_inspection/api_formData`,u);console.log(S.data)},fe=n=>/^\d{2,3}\.\d{2}$/.test(n.trim()),ot=async()=>{var S;let n=0,c=0;const u=(S=ue==null?void 0:ue.filter(P=>P.checked===!0))==null?void 0:S.map(P=>P.id_result);if(T.forEach(P=>{fe(P.usl)?console.log("OK"):n+=1,fe(P.lsl)?console.log("OK"):c+=1}),u.length>0)if(c!==0)z.fire({icon:"warning",title:"Invalid format LSL",text:"Format ข้อมูล LSL ไม่ถูกต้อง"});else if(n!==0)z.fire({icon:"warning",title:"Invalid format USL",text:"Format ข้อมูล USL ไม่ถูกต้อง"});else{const P={router:"addPart",bsthPartNo:q,partName:G,customerPartNo:J,customerName:H,model:ce,justOn:v?"X,Y":"AVG",resultCheck:lt(u),standardValue:T==null?void 0:T.map((g,ve)=>({point:ve+1,lsl:g.lsl,usl:g.usl}))};await Z.post(`${$}/backend_qc_inspection/api`,P).then(g=>{g.data.err?z.fire({icon:"error",title:g.data.msg}):!g.data.err&&g.data.status==="Ok"&&(se!==null&&at(se,q),Oe(),U(),Y(!1),z.fire({icon:"success",title:g.data.msg,showCancelButton:!1,showConfirmButton:!1,timer:700}))}).catch(g=>{console.log(g)})}else z.fire({icon:"warning",title:"กรุณาเลือก Result"});console.log(se)},it=n=>{const c=/^[a-zA-Z0-9]*$/;let u=n.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"");u.length>9&&(u=u.slice(0,9));let S="";u.length>=7?S=`${u.slice(0,6)}-${u.slice(6)}`:S=u,c.test(u)?D(S):console.log("Only English characters are allowed.")};return o.useEffect(()=>{U(),Ce(ye)},[U,M]),e.jsxs(yt,{children:[e.jsxs(Ve,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(i,{variant:"h4",children:"Parts Master"}),e.jsx(le,{variant:"contained",color:"inherit",startIcon:e.jsx(oe,{icon:"eva:plus-fill"}),onClick:()=>{Y(!0),setTimeout(()=>{xe.current.focus()},100)},children:"New Part"})]}),e.jsx(De,{open:Q,onClose:()=>{Y(!1),Oe()},"aria-labelledby":"child-modal-title","aria-describedby":"child-modal-description",children:e.jsxs(_,{sx:{...j,width:"80%",height:"90%",overflow:"hidden",overflowY:"auto"},children:[e.jsx("h3",{id:"child-modal-title",children:"Add Part and Setting standard"}),e.jsx("div",{className:"h-[90%] overflow-auto",children:e.jsxs(O,{container:!0,spacing:2,marginTop:2,children:[e.jsxs(O,{item:!0,xs:12,lg:5,children:[e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsxs(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:["PSTH PartNo : ",q]}),e.jsx(L,{value:q,inputRef:xe,onChange:it,size:"small",placeholder:"PSTH PartNo"})]}),e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Part Name :"}),e.jsx(L,{value:G,onChange:n=>{A(n.target.value)},size:"small",placeholder:"Part name"})]}),e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Model :"}),e.jsx(L,{value:ce,onChange:n=>{V(n.target.value)},size:"small",placeholder:"Model"})]}),e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Customer :"}),e.jsx(L,{value:H,onChange:n=>{ee(n.target.value)},size:"small",placeholder:"Customer"})]}),e.jsxs(R,{sx:{marginBottom:"0.5rem"},fullWidth:!0,children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Customer Part No :"}),e.jsx(L,{fullWidth:!0,value:J,onChange:n=>{F(n.target.value)},size:"small",placeholder:"Customer Part No"})]}),e.jsx("div",{children:e.jsxs(R,{sx:{marginBottom:"0.5rem"},children:[e.jsxs(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:["Just : ",v?"X,Y":"Avg"]}),e.jsxs(_,{sx:{display:"flex",alignItems:"center",gap:"0px 10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(he,{value:"X,Y",checked:v,onChange:n=>{v||W(n.target.checked)}}),e.jsx(i,{children:"X,Y"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(he,{value:"AVG",checked:!v,onChange:n=>{W(!1)}}),e.jsx(i,{children:"AVG"})]})]})]})})]}),e.jsxs(O,{item:!0,xs:12,lg:7,children:[e.jsxs(R,{sx:{marginBottom:"0.5rem"},children:[e.jsx(i,{fontSize:14,sx:{fontWeight:"bold",marginRight:"15px"},children:"Number of check points :"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px 10px"},children:[e.jsx(le,{size:"small",color:"error",onClick:()=>{y(n=>n!==1?n-1:1),B!==1&&me(n=>n.slice(0,-1))},children:e.jsx(Je,{fontSize:20})}),e.jsx(i,{fontWeight:"bold",children:B}),e.jsx(le,{size:"small",onClick:()=>{y(n=>n<4?n+1:4),me(n=>B<4?[...n,{usl:"",lsl:""}]:n)},children:e.jsx(Ge,{fontSize:17})})]})]}),e.jsx(O,{container:!0,spacing:2,children:new Array(B).fill("").map((n,c)=>{var Re,ze,Te,_e;const S=(Re=T[c])==null?void 0:Re.usl,P=S!==void 0&&fe(S)===!1,g=(ze=T[c])==null?void 0:ze.lsl,ve=g!==void 0&&fe(g)===!1;return console.log(10),e.jsx(O,{item:!0,xs:12,lg:6,children:e.jsx(Ne,{children:e.jsxs(Ke,{children:[e.jsx(_,{sx:{display:"flex"},children:e.jsxs(i,{fontSize:14,marginBottom:1,children:["Point Check No. ",c+1]})}),e.jsxs(_,{sx:{display:"flex",gap:"0px 5px"},children:[e.jsxs("div",{children:[e.jsxs(i,{fontSize:11,marginLeft:1,children:["LSL Point ",c+1]}),e.jsx(L,{size:"small",sx:{width:100},placeholder:`LSL ${c+1}`,value:(Te=T[c])==null?void 0:Te.lsl,onChange:Pe=>{ke(c,"lsl",Pe.target.value)},error:ve})]}),e.jsxs("div",{children:[e.jsxs(i,{fontSize:11,marginLeft:1,children:["USL Point ",c+1]}),e.jsx(L,{size:"small",sx:{width:100},placeholder:`USL ${c+1}`,value:(_e=T[c])==null?void 0:_e.usl,error:P,onChange:Pe=>{ke(c,"usl",Pe.target.value)}})]})]}),e.jsx(i,{color:"red",fontSize:12,marginTop:1,children:"*หมายเหตุ 00.01 - 150.00 เท่านั้น"})]})})},c)})}),e.jsxs(O,{container:!0,children:[e.jsx(O,{item:!0,xs:12,lg:12,children:e.jsxs(_,{className:"flex items-center gap-x-1 mt-[1rem]",children:[e.jsx(i,{fontSize:12,children:"Upload File Image (.png, .jpg only) :"}),e.jsx("button",{className:"w-[2.5rem] cursor-pointer h-[2.5rem] border-2 flex justify-center items-center border-dashed",onClick:x,type:"button",children:e.jsx("i",{className:"fa-solid fa-plus text-blue-500 text-[12px]"})}),e.jsx("input",{ref:te,accept:".png, .jpg",style:{display:"none"},multiple:!0,type:"file",onChange:n=>{n.target.files[0].size/(1024*1024)>2?z.fire({icon:"warning",title:"Error File size",text:"อนุญาตอัพโหลดไม่เกิน 2 Mb ต่อไฟล์"}):n.target.files[0].type!=="image/jpeg"&&n.target.files[0].type!=="image/png"?z.fire({icon:"warning",title:"Error File type",text:"อนุญาตอัพโหลดไฟล์ .png .jpg เท่านั้น"}):a(n.target.files[0])}}),se!==null?e.jsx(i,{fontSize:12,color:"#0388fc",children:se.name}):null]})}),e.jsxs(O,{item:!0,xs:12,lg:12,children:[e.jsx(i,{fontSize:14,fontWeight:"bold",marginTop:"1rem",children:"Result :"}),e.jsx(_,{sx:{display:"flex"},children:e.jsx("table",{style:{width:"100%"},children:e.jsx("tbody",{style:{fontSize:14},children:ye.map((n,c)=>{var u,S;return e.jsx("tr",{children:e.jsxs("td",{children:[e.jsx(he,{defaultChecked:(u=ue[c])==null?void 0:u.checked,onChange:P=>{nt(P.target.checked,c)},checked:(S=ue[c])==null?void 0:S.checked}),n.name_result]})},c)})})})}),e.jsx(_,{children:e.jsx("div",{style:{marginTop:20},children:e.jsx("div",{children:e.jsx(le,{variant:"contained",onClick:ot,children:"Submit"})})})})]})]})]})]})})]})}),e.jsxs(Ne,{children:[e.jsx(rt,{filterName:C,onFilterName:re}),e.jsx(xt,{children:e.jsx(Wt,{sx:{overflow:"unset"},children:e.jsxs(jt,{sx:{minWidth:800},children:[e.jsx(tt,{order:s,orderBy:d,rowCount:E.length,onRequestSort:b,headLabel:[{id:"image",label:"Drawing"},{id:"bsthPartNo",label:"Part No."},{id:"partName",label:"Part name"},{id:"customerName",label:"Customer"},{id:"model",label:"Model",align:"center"},{id:"customerPartNo",label:"Customer Part"},{id:"point",label:"Point",align:"center"},{id:"justOn",label:"Judge"},{id:"",label:"Action"}]}),e.jsxs(bt,{children:[K.slice(t*p,t*p+p).map(n=>e.jsx(et,{bsthPartNo:n.BSNCR_PART_NO,partName:n.PART_NAME,customerName:n.CUSTOMER_NAME,model:n.MODEL,customerPartNo:n.CUSTOMER_PART_NO,justOn:n.JUST_ON,point:n.AMOUNT_POINT,getAllPart:U,render:N,file:n.FILENAME},n.Id)),e.jsx(st,{height:77,emptyRows:qt(t,p,E.length)}),ne&&e.jsx(Ze,{query:C})]})]})})}),e.jsx(Ct,{page:t,component:"div",count:E.length,rowsPerPage:p,onPageChange:k,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:de})]})]})}function ss(){return e.jsxs(e.Fragment,{children:[e.jsx(ft,{}),e.jsx(mt,{children:e.jsx("title",{children:" Lists | Parts Master"})}),e.jsx(Xt,{})]})}export{ss as default};
