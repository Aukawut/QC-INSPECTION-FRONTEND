import{O as Zt,r as o,y as ea,m as he,h as t,M as Me,n as p,B as ne,T as m,o as ta,W as aa}from"./index-2c69281d.js";import{A as sa}from"./AuthToken-1bdb7683.js";import{S as ie}from"./sweetalert2.all-34f271eb.js";import{T as la,b as ra,c as Lt,d as St,i as oa,X as na,R as ca}from"./RBarChart-a66df0a7.js";import{L as _e}from"./label-282cadd9.js";import{M as ia}from"./modal-control-chart-f67dd531.js";import{T as L,F as da,I as ua,S as ma}from"./TextField-d07e4572.js";import{G as Re}from"./KeyboardArrowRight-13bf3a5b.js";const we=[{id:1,time:"09:00"},{id:2,time:"13:00"},{id:3,time:"17:00"},{id:4,time:"21:00"},{id:5,time:"01:00"},{id:6,time:"05:00"}],ha=[{id:1,data:30},{id:2,data:50},{id:3,data:100}],pa=()=>{var pt,xt,ft,Nt,Ct,jt;const S="http://backend-qcinspection",g=Zt(),[i,Pe]=o.useState([]),[d,vt]=o.useState([]),[c,ge]=o.useState([]),[h,Ie]=o.useState([]),[x,Xe]=o.useState([]),[pe,ze]=o.useState(""),[xe,Je]=o.useState(""),[fe,Ee]=o.useState(""),[Ne,Ye]=o.useState(""),[ce,De]=o.useState(""),[Ue,$e]=o.useState(""),[Ft,bt]=o.useState(!1),[_t,Ut]=o.useState(""),[Be,Ve]=o.useState([]),[We,yt]=o.useState([]),[Ke,Ot]=o.useState([]),[Ce,kt]=o.useState(new Date),[v,Ge]=o.useState([]),[qe,Tt]=o.useState(""),[At,He]=o.useState(!1),[de,Mt]=o.useState(100),[Rt,Qe]=o.useState("1"),[ye,Ze]=o.useState([]),[et,Oe]=o.useState(""),[wt,Le]=o.useState(!1),[Pt,tt]=o.useState(!1),[It,Se]=o.useState(!1),je=o.useRef(null),le=o.useRef([]),re=o.useRef([]),ve=o.useRef(null),at=o.useRef(null),Fe=o.useRef(null),st=o.useRef(null),lt=o.useRef(null),rt=o.useRef(null),ke=o.useRef([]),Xt=ea(a=>a.render),zt=a=>{const e=a.target.value;(/^\d{1}-\d{1,2}$|^\d{1}-$|^\d{1}$/.test(e)||e==="")&&ze(e)},Jt=a=>{const e=a.target.value;(/^\d{1}-\d{1,2}$|^\d{1}-$|^\d{1}$/.test(e)||e==="")&&Je(e)},Te={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",borderRadius:"15px",boxShadow:"rgba(158, 199, 243, 0.65) 0 0 15px 2px",pt:2,px:4,pb:3},[Et,ot]=o.useState(!1),Yt=()=>{ot(!0);const a=c.map((e,l)=>({AMOUNT:e.AMOUNT,AVG_R:e.AVG_R,AVG_X:e.AVG_X,BSNCR_PART_NO:e.BSNCR_PART_NO,LCL_MANUAL:e.LCL,MOLD_NO:e.MOLD_NO,POINT_NO:e.POINT_NO,R_LCL_MANUAL:e.R_LCL,R_UCL_MANUAL:e.R_UCL,SUM_R:e.SUM_R,SUM_X:e.SUM_X,UCL_MANUAL:e.UCL}));Ge(a)},Ae=()=>{ot(!1),Qe("1")};console.log("btnTimeRef",ke);const nt=o.useCallback(async()=>{const a=await he.post(`${S}/backend_qc_inspection/api`,{router:"getStandardByPart",bsthPartNo:g.partNo});a.data.err?console.log(a.data.msg):!a.data.err&&a.data.status==="Ok"&&vt(a.data.result)},[S,g.partNo]),ct=o.useCallback(async()=>{await he.post(`${S}/backend_qc_inspection/api`,{router:"getStandardInspection",bsthPartNo:g.partNo}).then(a=>{if(a.data.err)Pe([]);else if(a.data.status==="Ok"&&!a.data.err){Pe(a.data.result);const e=a.data.result.filter(n=>parseInt(n.POINT_NO,10)===1),l=[],u=[];for(let n=1;n<=parseInt(a.data.result[0].AMOUNT_POINT,10);n+=1)l.push({valueCheck:e.map((s,C)=>({id_result:parseInt(s.ID_RESULT,10),name_result:s.NAME_RESULT,lsl:s.LSL,usl:s.USL,value:"",point:n}))}),u.push({valueCheck:e.map((s,C)=>({id_result:parseInt(s.ID_RESULT,10),name_result:s.NAME_RESULT,lsl:s.LSL,usl:s.USL,value2:"",point:n}))});Ie(l),Xe(u)}}).catch(a=>{console.log(a)})},[S,g.partNo]);console.log("standardPart",d);const it=(a,e,l)=>{if(!/^\d+(\.\d{0,2})?$/.test(a)&&a!==""){console.error("Invalid float format. Expected format: xx.xx");return}const n=[...h];n[e].valueCheck[l].value=a,Ie(n)},dt=(a,e,l)=>{if(!/^\d+(\.\d{0,2})?$/.test(a)&&a!==""){console.error("Invalid float format. Expected format: xx.xx");return}const n=[...x];n[e].valueCheck[l].value2=a,Xe(n)},Dt=(a,e,l)=>{a.key==="Enter"&&(l<le.current[e].length-1?le.current[e][l+1].focus():e<le.current.length-1&&le.current[e+1][0].focus(),l===le.current[e].length-1&&e===le.current.length-1&&(console.log("ถึงตัวสุดท้าย"),at.current.focus(),je.current.scrollTop=0))};console.log(_t);const $t=(a,e,l)=>{a.key==="Enter"&&a.key==="Enter"&&(l<re.current[e].length-1?re.current[e][l+1].focus():e<re.current.length-1&&re.current[e+1][0].focus(),l===re.current[e].length-1&&e===re.current.length-1&&(console.log("ถึงตัวสุดท้าย"),ve.current.value===""?ve.current.focus():rt.current.focus()))},Bt=()=>{var u,n;let a=0,e=0;const l=(s,C)=>{/^\d+\.\d{2}$/.test(s)||(C===1?a+=1:C===2&&(e+=1))};for(let s=0;s<h.length;s+=1)(u=h[s].valueCheck)==null||u.map(C=>l(C.value,1)),(n=x[s].valueCheck)==null||n.map(C=>l(C.value2,2));return!(a!==0||e!==0)},Vt=()=>{$e(""),Ee(""),De(""),Ye(""),ze(""),Je("")},Wt=()=>{je.current.scrollTop=0,Fe.current.focus(),document.documentElement.scrollTop=0,document.body.scrollTop=0},ut=(a,e,l)=>{const u=/^\d+(\.\d{0,2})?$/;console.log(u);const n=[...v];if(!u.test(a)&&a!==""){console.log("Format Error");return}l==="lcl"?n[e].LCL_MANUAL=a:l==="ucl"&&(n[e].UCL_MANUAL=a),Ge(n)},[Kt,mt]=o.useState(!1),Gt=()=>{const a=/^\d+\.\d{2}$/;let e=0,l=0,u=0;for(let n=0;n<(c==null?void 0:c.length);n+=1)(!a.test(v[n].UCL_MANUAL)||v[n].UCL_MANUAL==="")&&(e+=1),(!a.test(v[n].LCL_MANUAL)||v[n].LCL_MANUAL==="")&&(l+=1),parseFloat(v[n].LCL_MANUAL)>v[n].UCL_MANUAL&&(u+=1);if(e!==0||l!==0)ie.fire({icon:"warning",title:"Error Format",text:"ระบุทศนิยม 2 ตำแหน่งเท่านั้น"});else if(u!==0)ie.fire({icon:"warning",title:"Error Value LCL UCL",text:"ค่า LCL UCL ไม่ถูกต้อง"});else{const n=v.map((s,C)=>({AMOUNT:s.AMOUNT,AVG_R:s.AVG_R,AVG_X:s.AVG_X,BSNCR_PART_NO:s.BSNCR_PART_NO,LCL:s.LCL_MANUAL,MOLD_NO:s.MOLD_NO,POINT_NO:s.POINT_NO,R_LCL:s.R_LCL_MANUAL,R_UCL:s.R_UCL_MANUAL,SUM_R:s.SUM_R,SUM_X:s.SUM_X,UCL:s.UCL_MANUAL}));ge(n),Ae(),mt(!0)}console.log(e),console.log(l),console.log(a)},qt=async()=>{await he.post(`${S}/backend_qc_inspection/api`,{router:"inspection",bsthPartNo:g.partNo,inspector:Ue,lotNo:fe,moldNo:Ne,time:ce,value:[{simple:1,cavity:pe,valueCheck:h},{simple:2,cavity:xe,valueCheck:x}]}).then(a=>{a.data.err?ie.fire({icon:"error",title:a.data.msg}):!a.data.err&&a.data.status==="Ok"&&(ie.fire({icon:"success",title:a.data.msg,timer:600,showCancelButton:!1,showConfirmButton:!1}).then(()=>{bt(e=>!e),Xt(),Vt(),Se(!1)}),setTimeout(()=>{Wt()},1500)),console.log(a.data)}).catch(a=>{console.log(a)})},Ht=async()=>{const a=/^\d{1}-\d{1,2}$/.test(pe),e=/^\d{1}-\d{1,2}$/.test(xe);fe===""||Ne===""||ce===""||pe===""||xe===""||Ue===""?ie.fire({icon:"warning",title:"Error Input From",text:"กรุณากรอกข้อมูลให้ครบถ้วน"}):Bt()?!a||!e?ie.fire({icon:"warning",title:"Format Cavity ไม่ถูกต้อง",text:"กรุณาระบุ Format x-x หรือ x-xx เท่านั้น"}):Se(!0):ie.fire({icon:"warning",title:"Format ไม่ถูกต้อง",text:"กรุณาระบุเลขทศนิยม 2 ตำแหน่ง"})},be=o.useCallback(async(a,e)=>{await he.post(`${S}/backend_qc_inspection/api`,{router:"getDataXBarChart",psthPartNo:g.partNo,moldNo:a,dateInspection:`${e} 23:59:00`}).then(l=>{l.data.err?(console.log(l.data.msg),Ve([])):Ve(l.data.result)}).catch(l=>{console.log(l)})},[S,g.partNo]),ue=o.useCallback(async(a,e,l)=>{Le(!0),await he.post(`${S}/backend_qc_inspection/api`,{router:"getXBarUCL",psthPartNo:g.partNo,n:2,dateInspection:`${l} 23:59:00`,MoldNo:e,top:a}).then(u=>{var n,s;u.data.err&&u.data.msg!=="Not Found!"?(ge([]),Le(!1)):!u.data.err&&u.data.status==="Ok"?(ge(u.data.result),yt((n=u.data.result[0])==null?void 0:n.MAX),Ot((s=u.data.result[1])==null?void 0:s.MIN),Le(!1),Ae(),mt(!1)):u.data.err&&u.data.msg==="Not Found!"&&(console.log("ไม่พบข้อมูล"),Le(!1),ge([]))}).catch(u=>{console.log(u)})},[S,g.partNo]),ht=o.useCallback(async()=>{await he.post(`${S}/backend_qc_inspection/api`,{router:"countMoldOfPsthPart",psthPartNo:g.partNo}).then(a=>{a.data.err?Ze([]):!a.data.err&&a.data.status==="Ok"&&(Ze(a.data.result),Oe(a.data.result[0].MOLD_NO),Ut(new Date().toJSON().slice(0,10)),ue(100,a.data.result[0].MOLD_NO,new Date().toJSON().slice(0,10)),be(a.data.result[0].MOLD_NO,new Date().toJSON().slice(0,10)))}).catch(a=>{console.log(a)})},[S,g.partNo,ue,be]),Qt=a=>{(a.target.value===""||a.target.value>0&&a.target.value<=10&&a.target.value!=="-"&&a.target.value!=="")&&(Ye(a.target.value),Oe(a.target.value)),a.target.value!==""&&a.target.value!=="0"&&a.target.value!==0&&(be(a.target.value,new Date().toJSON().slice(0,10)),ue(de,a.target.value,new Date().toJSON().slice(0,10)))};return o.useEffect(()=>{console.log("Effefct"),ct(),nt(),ht(),Fe.current.focus(),je.current.scrollTop=0},[ct,nt,Fe,Ft,je,ht,ue]),t.jsxs("div",{ref:je,style:{overflowY:"auto",maxHeight:"calc(100vh - 100px)"},children:[t.jsx(ia,{isOpen:At,handleClose:()=>He(!1)}),t.jsx(Me,{open:Et,onClose:Ae,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:t.jsx(p,{sx:{...Te,height:"80%",overflow:"hidden",overflowY:"auto"},className:"w-[80%] lg:w-[50%]",children:t.jsxs(la,{value:Rt,children:[t.jsx(p,{sx:{borderBottom:1,borderColor:"divider"},children:t.jsxs(ra,{onChange:(a,e)=>Qe(e),"aria-label":"lab API tabs example",children:[t.jsx(Lt,{label:"Calculate",value:"1"}),t.jsx(Lt,{label:"Input Manual",value:"2"})]})}),t.jsxs(St,{value:"1",children:[t.jsxs("h2",{children:[t.jsx("i",{className:"fa-solid fa-calculator text-[17px] mr-2"}),"Calculate | UCL , LCL (",g.partNo,")"]}),t.jsxs(p,{className:"mt-[2rem]",children:[t.jsx(oa,{maxDate:new Date,onChange:a=>kt(a),dateFormat:"dd MMMM yyyy",selected:Ce,customInput:t.jsx(L,{value:Ce,id:"standard-basic",label:"Date",placeholder:"Select Date",variant:"standard"})}),t.jsx("div",{className:"grid grid-cols-3 gap-2 mt-[1rem]",children:ha.map((a,e)=>t.jsx("button",{value:a.data,type:"button",onClick:l=>{Mt(l.target.value)},className:`p-[5px] flex justify-center rounded-[5px] ${a.data===parseInt(de,10)?"bg-violet-400 text-white transition-all duration-300":"bg-violet-100 text-gray-800 transition-all duration-300"}`,children:a.data},e))}),t.jsxs("div",{className:"mt-[2rem]",children:["* Calculate from ",Ce.toJSON().slice(0,10)," Last ",de," Data"]}),t.jsx(p,{className:"mt-[2rem]",children:t.jsx(ne,{variant:"contained",onClick:()=>{ue(de,et,Ce.toJSON().slice(0,10))},children:wt?"Process.....":"Calculate"})})]})]}),t.jsxs(St,{value:"2",children:[t.jsxs(m,{children:[t.jsx("i",{className:"fa-solid fa-file-pen"})," Input Manual (",g.partNo,")"]}),d==null?void 0:d.map((a,e)=>t.jsxs("div",{children:[t.jsxs(m,{fontSize:12,children:[t.jsx("i",{className:"fa-solid fa-arrow-right mr-2 text-[red]"}),"Point No.",a.POINT_NO]}),t.jsxs(m,{fontSize:12,children:["SPEC : ",a==null?void 0:a.LSL," - ",a==null?void 0:a.USL," mm"]})]},e)),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-2 mt-1",children:c==null?void 0:c.map((a,e)=>{var l,u;return t.jsxs(p,{className:"flex justify-center flex-col items-start border-[1px] p-2",children:[t.jsxs(_e,{color:"primary",className:"my-1",children:["Point No. ",e+1]}),t.jsx("div",{className:"mb-[1rem]",children:t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx(m,{fontSize:12,children:"LCL :"}),t.jsx(L,{size:"small",placeholder:"LCL",value:(l=v[e])==null?void 0:l.LCL_MANUAL,className:"w-[120px]",onChange:n=>ut(n.target.value,e,"lcl")})]})}),t.jsx("div",{children:t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx(m,{fontSize:12,children:"UCL :"}),t.jsx(L,{size:"small",placeholder:"UCL",value:(u=v[e])==null?void 0:u.UCL_MANUAL,className:"w-[120px]",onChange:n=>ut(n.target.value,e,"ucl")})]})})]})})}),t.jsx(p,{className:"mt-[1rem]",children:t.jsx(ne,{variant:"contained",onClick:Gt,children:"OK"})})]})]})})}),t.jsx(Me,{open:Pt,onClose:()=>tt(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:t.jsx(p,{sx:{...Te,height:"90%",width:"80%",overflow:"hidden",overflowY:"auto"},children:t.jsx("img",{src:`${S}/backend_qc_inspection/uploads/drawing/${qe}`,alt:qe,width:"100%",height:"auto"})})}),t.jsx(Me,{open:It,onClose:()=>Se(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:t.jsxs(p,{sx:{...Te,height:"90%",width:"60%",overflow:"hidden",overflowY:"auto"},children:[t.jsxs(p,{children:[t.jsxs("div",{className:"flex gap-x-2",children:[t.jsxs(m,{fontWeight:"bold",children:["PSTH Part No : ",g.partNo]}),t.jsx(_e,{color:((pt=i[0])==null?void 0:pt.JUST_ON)==="X,Y"&&"info"||"primary",children:(xt=i[0])==null?void 0:xt.JUST_ON})]}),t.jsxs(m,{fontSize:12,fontWeight:"bold",children:["Customer Name : ",(ft=i[0])==null?void 0:ft.CUSTOMER_NAME]}),d==null?void 0:d.map((a,e)=>t.jsxs("div",{children:[t.jsxs(m,{fontSize:12,children:[t.jsx("i",{className:"fa-solid fa-arrow-right mr-2 text-[red]"}),"Point No.",a.POINT_NO]}),t.jsxs(m,{fontSize:12,children:["SPEC : ",a==null?void 0:a.LSL," - ",a==null?void 0:a.USL," mm"]})]},e))]}),t.jsx("hr",{}),t.jsxs(p,{className:"flex gap-x-2 my-[1rem]",children:[t.jsx(ne,{variant:"contained",onClick:qt,children:"Confirm"}),t.jsx(ne,{variant:"contained",color:"error",onClick:()=>Se(!1),children:"Close"})]}),t.jsxs("div",{className:"flex ml-[8rem] gap-x-3 mt-3",children:[t.jsxs("div",{className:"flex flex-col justify-center text-center",children:[t.jsx("p",{children:"Sample 1"}),t.jsx(L,{placeholder:"Cavity No.",size:"small",sx:{width:90},value:pe,disabled:!0})]}),t.jsxs("div",{className:"flex flex-col justify-center text-center",children:[t.jsx("p",{children:"Sample 2"}),t.jsx(L,{placeholder:"Cavity No.",size:"small",sx:{width:90},value:xe,disabled:!0})]})]}),t.jsxs(p,{className:"flex gap-x-5",children:[t.jsx(p,{children:Array.from({length:h.length}).map((a,e)=>{var C,F,b,_,U;const l=(C=h[e].valueCheck)==null?void 0:C.map(N=>parseFloat(N.value).toFixed(2)),s=l.map(N=>parseFloat(N)).reduce((N,r)=>N+r,0)/l.length;return t.jsxs("div",{children:[t.jsx("div",{className:"flex items-center",children:t.jsxs("p",{className:"font-bold text-[14px]",children:["Point No. ",e+1," "]})}),Array.isArray(h[e].valueCheck)?t.jsxs("div",{children:[h[e].valueCheck.map((N,r)=>{var j,f,y,O,k,T,A,M,R,w,P,I,X,z,J,E,Y,D,$,B,V,W,K,G,q,H,Q,Z,ee,te,ae,se;return t.jsx("div",{children:t.jsx("table",{children:t.jsx("tbody",{children:t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("p",{className:"mr-2",children:N.name_result})}),t.jsx("td",{children:t.jsx("p",{children:t.jsx(L,{size:"small",style:{width:90},value:h[e].valueCheck[r].value||"",sx:parseFloat((j=c[e])==null?void 0:j.UCL)<parseFloat((y=(f=h[e])==null?void 0:f.valueCheck[r])==null?void 0:y.value)&&((O=i[0])==null?void 0:O.JUST_ON)==="X,Y"||parseFloat((k=c[e])==null?void 0:k.LCL)>parseFloat((A=(T=h[e])==null?void 0:T.valueCheck[r])==null?void 0:A.value)&&((M=i[0])==null?void 0:M.JUST_ON)==="X,Y"||parseFloat((R=d[e])==null?void 0:R.USL)<parseFloat((P=(w=h[e])==null?void 0:w.valueCheck[r])==null?void 0:P.value)&&((I=i[0])==null?void 0:I.JUST_ON)==="X,Y"||parseFloat((X=d[e])==null?void 0:X.LSL)>parseFloat((J=(z=h[e])==null?void 0:z.valueCheck[r])==null?void 0:J.value)&&((E=i[0])==null?void 0:E.JUST_ON)==="X,Y"?{background:"red",color:"#fff",borderRadius:"8px",input:{color:"white"}}:{color:"black"},error:parseFloat((Y=c[e])==null?void 0:Y.UCL)<parseFloat(($=(D=h[e])==null?void 0:D.valueCheck[r])==null?void 0:$.value)&&((B=i[0])==null?void 0:B.JUST_ON)==="X,Y"||parseFloat((V=c[e])==null?void 0:V.LCL)>parseFloat((K=(W=h[e])==null?void 0:W.valueCheck[r])==null?void 0:K.value)&&((G=i[0])==null?void 0:G.JUST_ON)==="X,Y"||parseFloat((q=d[e])==null?void 0:q.USL)<parseFloat((Q=(H=h[e])==null?void 0:H.valueCheck[r])==null?void 0:Q.value)&&((Z=i[0])==null?void 0:Z.JUST_ON)==="X,Y"||parseFloat((ee=d[e])==null?void 0:ee.LSL)>parseFloat((ae=(te=h[e])==null?void 0:te.valueCheck[r])==null?void 0:ae.value)&&((se=i[0])==null?void 0:se.JUST_ON)==="X,Y"})})})]})})})},r)}),t.jsxs("div",{className:"flex items-center mt-[1rem]",children:[t.jsx(m,{children:"Average ="}),t.jsx(p,{className:s.toFixed(2)>((F=c[e])==null?void 0:F.UCL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)<((b=c[e])==null?void 0:b.LCL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)>((_=d[e])==null?void 0:_.USL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)<((U=d[e])==null?void 0:U.LSL)&&!Number.isNaN(parseFloat(s.toFixed(2)))?"ml-[4rem] p-2 rounded-md bg-[red] flex justify-center text-[white]":"ml-[4rem] p-2 rounded-md bg-slate-100 flex justify-center text-[#313131]",width:80,children:t.jsx(m,{fontSize:14,children:Number.isNaN(parseFloat(s.toFixed(2)))?"Wait..":s.toFixed(2)})})]})]}):t.jsx("p",{children:"Not an array"}),t.jsx("div",{className:"mb-[1rem] mt-[1rem]",children:t.jsx("hr",{})})]},e)})}),t.jsx(p,{children:Array.from({length:x.length}).map((a,e)=>{var C,F,b,_,U;const l=(C=x[e].valueCheck)==null?void 0:C.map(N=>parseFloat(N.value2).toFixed(2)),s=l.map(N=>parseFloat(N)).reduce((N,r)=>N+r,0)/l.length;return t.jsxs("div",{children:[t.jsx("div",{className:"flex items-center",children:t.jsx("p",{className:"font-bold text-[14px]",children:"-"})}),Array.isArray(x[e].valueCheck)?x[e].valueCheck.map((N,r)=>{var j,f,y,O,k,T,A,M,R,w,P,I,X,z,J,E,Y,D,$,B,V,W,K,G,q,H,Q,Z,ee,te,ae,se;return t.jsx("div",{children:t.jsx("table",{children:t.jsx("tbody",{children:t.jsx("tr",{children:t.jsx("td",{children:t.jsx("p",{children:t.jsx(L,{size:"small",value:x[e].valueCheck[r].value2||"",sx:parseFloat((j=c[e])==null?void 0:j.UCL)<parseFloat((y=(f=x[e])==null?void 0:f.valueCheck[r])==null?void 0:y.value2)&&((O=i[0])==null?void 0:O.JUST_ON)==="X,Y"||parseFloat((k=c[e])==null?void 0:k.LCL)>parseFloat((A=(T=x[e])==null?void 0:T.valueCheck[r])==null?void 0:A.value2)&&((M=i[0])==null?void 0:M.JUST_ON)==="X,Y"||parseFloat((R=d[e])==null?void 0:R.USL)<parseFloat((P=(w=x[e])==null?void 0:w.valueCheck[r])==null?void 0:P.value2)&&((I=i[0])==null?void 0:I.JUST_ON)==="X,Y"||parseFloat((X=d[e])==null?void 0:X.LSL)>parseFloat((J=(z=x[e])==null?void 0:z.valueCheck[r])==null?void 0:J.value2)&&((E=i[0])==null?void 0:E.JUST_ON)==="X,Y"?{width:90,background:"red",color:"#fff",borderRadius:"8px",input:{color:"white"}}:{width:90,color:"black"},error:parseFloat((Y=c[e])==null?void 0:Y.UCL)<parseFloat(($=(D=x[e])==null?void 0:D.valueCheck[r])==null?void 0:$.value2)&&((B=i[0])==null?void 0:B.JUST_ON)==="X,Y"||parseFloat((V=c[e])==null?void 0:V.LCL)>parseFloat((K=(W=x[e])==null?void 0:W.valueCheck[r])==null?void 0:K.value2)&&((G=i[0])==null?void 0:G.JUST_ON)==="X,Y"||parseFloat((q=d[e])==null?void 0:q.USL)<parseFloat((Q=(H=x[e])==null?void 0:H.valueCheck[r])==null?void 0:Q.value2)&&((Z=i[0])==null?void 0:Z.JUST_ON)==="X,Y"||parseFloat((ee=d[e])==null?void 0:ee.LSL)>parseFloat((ae=(te=x[e])==null?void 0:te.valueCheck[r])==null?void 0:ae.value2)&&((se=i[0])==null?void 0:se.JUST_ON)==="X,Y"})})})})})})},r)}):t.jsx("p",{children:"Not an array"}),t.jsx(p,{className:s.toFixed(2)>((F=c[e])==null?void 0:F.UCL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)<((b=c[e])==null?void 0:b.LCL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)>((_=d[e])==null?void 0:_.USL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)<((U=d[e])==null?void 0:U.LSL)&&!Number.isNaN(parseFloat(s.toFixed(2)))?"mt-[1rem] ml-2 p-2 rounded-md bg-[red] flex justify-center text-[white]":"mt-[1rem] ml-2 p-2 rounded-md bg-slate-100 flex justify-center text-[#313131]",width:80,children:t.jsx(m,{fontSize:14,children:Number.isNaN(parseFloat(s.toFixed(2)))?"Wait..":s.toFixed(2)})}),t.jsx("div",{className:"mb-[1rem] mt-[1rem]",children:t.jsx("hr",{})})]},e)})})]})]})}),t.jsxs(Re,{container:!0,children:[t.jsxs(Re,{item:!0,xs:12,lg:8,children:[t.jsxs(p,{children:[t.jsxs("div",{className:"flex gap-x-2",children:[t.jsxs(m,{fontWeight:"bold",children:["PSTH Part No : ",g.partNo]}),t.jsx(_e,{color:((Nt=i[0])==null?void 0:Nt.JUST_ON)==="X,Y"&&"info"||"primary",children:(Ct=i[0])==null?void 0:Ct.JUST_ON})]}),t.jsxs(m,{fontSize:12,fontWeight:"bold",children:["Customer Name : ",(jt=i[0])==null?void 0:jt.CUSTOMER_NAME]}),d==null?void 0:d.map((a,e)=>t.jsxs("div",{children:[t.jsxs(m,{fontSize:12,children:[t.jsx("i",{className:"fa-solid fa-arrow-right mr-2 text-[red]"}),"Point No.",a.POINT_NO]}),t.jsxs(m,{fontSize:12,children:["SPEC : ",a==null?void 0:a.LSL," - ",a==null?void 0:a.USL," mm"]})]},e))]}),t.jsx(p,{className:"mt-[1rem] mb-1",children:t.jsxs(da,{className:"w-[200px]",children:[t.jsx(ua,{id:"demo-simple-select-label",children:"Mold No."}),t.jsx(ma,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:et,label:"Mold No",size:"small",onChange:a=>{be(a.target.value,new Date().toJSON().slice(0,10)),ue(de,a.target.value,new Date().toJSON().slice(0,10)),Oe(a.target.value)},children:ye==null?void 0:ye.map((a,e)=>t.jsx(ta,{value:a.MOLD_NO,children:a.MOLD_NO},e))})]})}),t.jsx(p,{className:"flex items-center gap-x-2 mb-2",children:t.jsx(ne,{variant:"contained",size:"small",sx:{marginTop:1},onClick:Yt,children:"Calculate UCL - LCL"})}),t.jsx(p,{children:d.map((a,e)=>{var l,u,n,s;return t.jsxs(t.Fragment,{children:[t.jsxs(_e,{color:"primary",children:["Point No. ",e+1]},e),Kt?t.jsx("div",{children:t.jsxs(m,{fontSize:12,marginTop:1,children:["Manual Input UCL = ",(n=v[e])==null?void 0:n.UCL_MANUAL," mm , LCL ="," ",(s=v[e])==null?void 0:s.LCL_MANUAL," mm"]})}):t.jsxs("div",{children:[t.jsxs(m,{fontSize:12,marginTop:1,children:["Calculated from ",de," Data dating back to"," ",Ce.toJSON().slice(0,10)," :"]}),t.jsxs(m,{fontSize:12,marginTop:1,children:["UCL = ",(l=c[e])==null?void 0:l.UCL," mm , LCL = ",(u=c[e])==null?void 0:u.LCL," mm"]})]}),t.jsxs(m,{fontSize:12,marginTop:1,children:["X Bar Chart - ",e+1]}),t.jsx(na,{isLoad:!1,lslValue:parseFloat(a==null?void 0:a.LSL),uslValue:parseFloat(a==null?void 0:a.USL),dataValue:Be,point:parseInt(e,10)+1,controlData:c,uclControl:We,lclControl:Ke},e),t.jsxs(m,{fontSize:12,marginTop:1,children:["R Bar Chart - ",e+1]}),t.jsx(ca,{isLoad:!1,lslValue:parseFloat(a==null?void 0:a.LSL),uslValue:parseFloat(a==null?void 0:a.USL),dataValue:Be,point:parseInt(e,10)+1,controlData:c,uclControl:We,lclControl:Ke},e)]})})})]}),t.jsx(Re,{item:!0,xs:12,lg:4,children:t.jsxs(p,{fontSize:12,marginTop:3,children:[t.jsxs(p,{className:"flex items-center mb-[1rem]",children:[t.jsx(m,{fontSize:12,fontWeight:"bold",marginRight:2,children:"Lot No. :"}),t.jsx(L,{onChange:a=>Ee(a.target.value),value:fe,sx:{marginLeft:1},size:"small",placeholder:"Lot No.",id:"outlined-basic",label:"Lot No",autoComplete:"off",variant:"outlined",inputRef:Fe,onKeyPress:a=>{a.target.value!==""&&a.key==="Enter"&&st.current.focus()}})]}),t.jsxs(p,{className:"flex items-center mb-[1rem]",children:[t.jsx(m,{fontSize:12,fontWeight:"bold",marginRight:2,children:"Mold No. :"}),t.jsx(L,{size:"small",placeholder:"Mold No.",id:"outlined-basic",label:"Mold No",autoComplete:"off",variant:"outlined",inputRef:st,type:"text",value:Ne,onChange:Qt,onKeyPress:a=>{a.key==="Enter"&&a.target.value!==""&&lt.current.focus()}})]}),t.jsxs(p,{className:"flex items-center mb-[0.2rem]",children:[t.jsx(m,{fontSize:12,fontWeight:"bold",marginRight:4,children:"Inspector :"}),t.jsx(L,{size:"small",placeholder:"Enter username such as AWK",id:"outlined-basic",inputProps:{style:{fontSize:15}},label:"Inspector",variant:"outlined",inputRef:lt,value:Ue,onChange:a=>{const e=/^[a-zA-Z0-9]*$/,l=a.target.value.replace(/[^a-zA-Z]/g,"");e.test(l)?$e(l.slice(0,4)):console.log("Only English characters are allowed.")},onKeyPress:a=>{a.key==="Enter"&&a.target.value!==""&&ke.current[0].focus()}})]}),t.jsx("span",{className:"text-[red] text-[12px] ml-[5rem]",children:"* Enter your username such as awk"}),t.jsxs(p,{className:"mt-[1rem]",children:[ce===""?t.jsxs(m,{fontSize:12,fontWeight:"bold",marginRight:2,component:"span",children:["Time : ",t.jsx("span",{className:"text-[red]",children:"* Not select time"})]}):t.jsxs(m,{fontSize:12,fontWeight:"bold",marginRight:2,component:"span",children:["Time : ",ce," น."]}),t.jsx("div",{className:"grid grid-cols-3 gap-2 p-2",children:we==null?void 0:we.map((a,e)=>t.jsx("button",{type:"button",ref:l=>{ke.current[e]=l},onClick:()=>{De(a.time),ve.current.focus()},className:`p-[5px] flex justify-center rounded-[5px] ${a.time===ce?"bg-violet-400 text-white transition-all duration-300":"bg-violet-100 text-gray-800 transition-all duration-300"}`,children:a.time},e))}),t.jsx("div",{className:"mb-2",children:t.jsxs(m,{fontSize:12,fontWeight:"bold",marginRight:2,component:"span",children:["Drawing :"," ",t.jsx(ne,{variant:"outlined",size:"small",onClick:()=>{Tt(d[0].FILENAME),tt(!0)},children:"Drawing"})]})}),t.jsx("div",{className:"mb-2",children:t.jsxs(m,{fontSize:12,fontWeight:"bold",marginRight:2,component:"span",children:["Control Chart :"," ",t.jsx(ne,{variant:"outlined",size:"small",onClick:()=>{He(!0)},children:"Control Chart"})]})})]}),t.jsx("hr",{}),t.jsxs("div",{className:"flex ml-[5.5rem] gap-x-2 mt-3",children:[t.jsxs("div",{className:"flex flex-col justify-center text-center",children:[t.jsx("p",{children:"Sample 1"}),t.jsx(L,{placeholder:"Cavity No.",size:"small",sx:{width:80},value:pe,inputRef:ve,onKeyPress:a=>{a.key==="Enter"&&le.current[0][0].focus()},disabled:fe===""||Ne===""||ce==="",onChange:zt})]}),t.jsxs("div",{className:"flex flex-col justify-center text-center",children:[t.jsx("p",{children:"Sample 2"}),t.jsx(L,{placeholder:"Cavity No.",size:"small",sx:{width:80},inputRef:at,value:xe,onChange:Jt,onKeyPress:a=>{a.key==="Enter"&&re.current[0][0].focus()},disabled:fe===""||Ne===""||ce===""})]})]}),t.jsxs(p,{className:"flex gap-x-5",children:[t.jsx(p,{children:Array.from({length:h.length}).map((a,e)=>{var C,F,b,_,U,N,r;const l=(C=h[e].valueCheck)==null?void 0:C.map(j=>parseFloat(j.value).toFixed(2)),s=l.map(j=>parseFloat(j)).reduce((j,f)=>j+f,0)/l.length;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-x-1 my-1",children:[t.jsxs("p",{className:"font-bold text-[14px]",children:["Point No. ",e+1," "]}),(c==null?void 0:c.length)!==0&&`${(F=c[e])==null?void 0:F.LCL} - ${(b=c[e])==null?void 0:b.UCL} mm`]}),Array.isArray(h[e].valueCheck)?t.jsxs("div",{children:[h[e].valueCheck.map((j,f)=>{var y,O,k,T,A,M,R,w,P,I,X,z,J,E,Y,D,$,B,V,W,K,G,q,H,Q,Z,ee,te,ae,se,oe,gt;return t.jsx("div",{children:t.jsx("table",{children:t.jsx("tbody",{children:t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("p",{className:"mr-2",children:j.name_result})}),t.jsx("td",{children:t.jsx("p",{children:t.jsx(L,{autoComplete:"off",onChange:me=>{it(me.target.value,e,f)},onKeyPress:me=>Dt(me,e,f),onFocus:()=>{it("",e,f)},size:"small",inputRef:me=>{le.current[e]||(le.current[e]=[]),me&&(le.current[e][f]=me)},style:{width:90},value:h[e].valueCheck[f].value||"",sx:parseFloat((y=c[e])==null?void 0:y.UCL)<parseFloat((k=(O=h[e])==null?void 0:O.valueCheck[f])==null?void 0:k.value)&&((T=i[0])==null?void 0:T.JUST_ON)==="X,Y"||parseFloat((A=c[e])==null?void 0:A.LCL)>parseFloat((R=(M=h[e])==null?void 0:M.valueCheck[f])==null?void 0:R.value)&&((w=i[0])==null?void 0:w.JUST_ON)==="X,Y"||parseFloat((P=d[e])==null?void 0:P.USL)<parseFloat((X=(I=h[e])==null?void 0:I.valueCheck[f])==null?void 0:X.value)&&((z=i[0])==null?void 0:z.JUST_ON)==="X,Y"||parseFloat((J=d[e])==null?void 0:J.LSL)>parseFloat((Y=(E=h[e])==null?void 0:E.valueCheck[f])==null?void 0:Y.value)&&((D=i[0])==null?void 0:D.JUST_ON)==="X,Y"?{background:"red",color:"#fff",borderRadius:"8px",input:{color:"white"}}:{color:"black"},error:parseFloat(($=c[e])==null?void 0:$.UCL)<parseFloat((V=(B=h[e])==null?void 0:B.valueCheck[f])==null?void 0:V.value)&&((W=i[0])==null?void 0:W.JUST_ON)==="X,Y"||parseFloat((K=c[e])==null?void 0:K.LCL)>parseFloat((q=(G=h[e])==null?void 0:G.valueCheck[f])==null?void 0:q.value)&&((H=i[0])==null?void 0:H.JUST_ON)==="X,Y"||parseFloat((Q=d[e])==null?void 0:Q.USL)<parseFloat((ee=(Z=h[e])==null?void 0:Z.valueCheck[f])==null?void 0:ee.value)&&((te=i[0])==null?void 0:te.JUST_ON)==="X,Y"||parseFloat((ae=d[e])==null?void 0:ae.LSL)>parseFloat((oe=(se=h[e])==null?void 0:se.valueCheck[f])==null?void 0:oe.value)&&((gt=i[0])==null?void 0:gt.JUST_ON)==="X,Y"})})})]})})})},f)}),t.jsxs("div",{className:"flex items-center mt-[1rem]",children:[t.jsx(m,{children:"Average = "}),t.jsx(p,{className:s.toFixed(2)>((_=c[e])==null?void 0:_.UCL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)<((U=c[e])==null?void 0:U.LCL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)>((N=d[e])==null?void 0:N.USL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)<((r=d[e])==null?void 0:r.LSL)&&!Number.isNaN(parseFloat(s.toFixed(2)))?"ml-[1.5rem] p-2 rounded-md bg-[red] flex justify-center text-[white]":"ml-[1.5rem] p-2 rounded-md bg-slate-100 flex justify-center text-[#313131]",width:80,children:t.jsx(m,{fontSize:14,children:Number.isNaN(parseFloat(s.toFixed(2)))?"Wait..":s.toFixed(2)})})]})]}):t.jsx("p",{children:"Not an array"}),t.jsx("div",{className:"mb-[1rem] mt-[1rem]",children:t.jsx("hr",{})})]},e)})}),t.jsx(p,{children:Array.from({length:x.length}).map((a,e)=>{var C,F,b,_,U;const l=(C=x[e].valueCheck)==null?void 0:C.map(N=>parseFloat(N.value2).toFixed(2)),s=l.map(N=>parseFloat(N)).reduce((N,r)=>N+r,0)/l.length;return t.jsxs("div",{children:[t.jsx("div",{className:"flex items-center my-1",children:t.jsx("p",{className:"font-bold text-[14px]",children:"-"})}),Array.isArray(x[e].valueCheck)?x[e].valueCheck.map((N,r)=>{var j,f,y,O,k,T,A,M,R,w,P,I,X,z,J,E,Y,D,$,B,V,W,K,G,q,H,Q,Z,ee,te,ae,se;return t.jsx("div",{children:t.jsx("table",{children:t.jsx("tbody",{children:t.jsx("tr",{children:t.jsx("td",{children:t.jsx("p",{children:t.jsx(L,{autoComplete:"off",size:"small",onChange:oe=>{dt(oe.target.value,e,r)},onFocus:()=>{dt("",e,r)},onKeyPress:oe=>$t(oe,e,r),inputRef:oe=>{re.current[e]||(re.current[e]=[]),oe&&(re.current[e][r]=oe)},value:x[e].valueCheck[r].value2||"",sx:parseFloat((j=c[e])==null?void 0:j.UCL)<parseFloat((y=(f=x[e])==null?void 0:f.valueCheck[r])==null?void 0:y.value2)&&((O=i[0])==null?void 0:O.JUST_ON)==="X,Y"||parseFloat((k=c[e])==null?void 0:k.LCL)>parseFloat((A=(T=x[e])==null?void 0:T.valueCheck[r])==null?void 0:A.value2)&&((M=i[0])==null?void 0:M.JUST_ON)==="X,Y"||parseFloat((R=d[e])==null?void 0:R.USL)<parseFloat((P=(w=x[e])==null?void 0:w.valueCheck[r])==null?void 0:P.value2)&&((I=i[0])==null?void 0:I.JUST_ON)==="X,Y"||parseFloat((X=d[e])==null?void 0:X.LSL)>parseFloat((J=(z=x[e])==null?void 0:z.valueCheck[r])==null?void 0:J.value2)&&((E=i[0])==null?void 0:E.JUST_ON)==="X,Y"?{width:90,background:"red",color:"#fff",borderRadius:"8px",input:{color:"white"}}:{width:90,color:"black"},error:parseFloat((Y=c[e])==null?void 0:Y.UCL)<parseFloat(($=(D=x[e])==null?void 0:D.valueCheck[r])==null?void 0:$.value2)&&((B=i[0])==null?void 0:B.JUST_ON)==="X,Y"||parseFloat((V=c[e])==null?void 0:V.LCL)>parseFloat((K=(W=x[e])==null?void 0:W.valueCheck[r])==null?void 0:K.value2)&&((G=i[0])==null?void 0:G.JUST_ON)==="X,Y"||parseFloat((q=d[e])==null?void 0:q.USL)<parseFloat((Q=(H=x[e])==null?void 0:H.valueCheck[r])==null?void 0:Q.value2)&&((Z=i[0])==null?void 0:Z.JUST_ON)==="X,Y"||parseFloat((ee=d[e])==null?void 0:ee.LSL)>parseFloat((ae=(te=x[e])==null?void 0:te.valueCheck[r])==null?void 0:ae.value2)&&((se=i[0])==null?void 0:se.JUST_ON)==="X,Y"})})})})})})},r)}):t.jsx("p",{children:"Not an array"}),t.jsx(p,{className:s.toFixed(2)>((F=c[e])==null?void 0:F.UCL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)<((b=c[e])==null?void 0:b.LCL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)>((_=d[e])==null?void 0:_.USL)&&!Number.isNaN(parseFloat(s.toFixed(2)))||s.toFixed(2)<((U=d[e])==null?void 0:U.LSL)&&!Number.isNaN(parseFloat(s.toFixed(2)))?"mt-[1rem] ml-2 p-2 rounded-md bg-[red] flex justify-center text-[white]":"mt-[1rem] ml-2 p-2 rounded-md bg-slate-100 flex justify-center text-[#313131]",width:80,children:t.jsx(m,{fontSize:14,children:Number.isNaN(parseFloat(s.toFixed(2)))?"Wait..":s.toFixed(2)})}),t.jsx("div",{className:"mb-[1rem] mt-[1rem]",children:t.jsx("hr",{})})]},e)})})]}),t.jsx(p,{children:t.jsx(ne,{variant:"contained",onClick:Ht,ref:rt,children:"Submit"})})]})})]})]})},xa=pa;function Fa(){return t.jsxs(t.Fragment,{children:[t.jsx(sa,{}),t.jsx(aa,{children:t.jsx("title",{children:" Inspection Part | QC Inspection System "})}),t.jsx(xa,{})]})}export{Fa as default};
